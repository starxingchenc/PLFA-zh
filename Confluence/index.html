<!DOCTYPE html>
<html lang="en">
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../public/css/style.css">
  
  <title>编程语言基础：Agda 语言描述 – Confluence</title>
  
  
  
</head>

    <body>
        <header class="site-header">
    <div class="wrapper">
        <a class="site-title" href="../">编程语言基础：Agda 语言描述</a>
        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="../">主页</a>
                <a class="page-link" href="../Announcements/">公告</a>
                <a class="page-link" href="../GettingStarted/">使用说明</a>
                <a class="page-link" href="../Citing/">引用</a>
                <a class="page-link" href="https://plfa.github.io/">English</a>
            </div>
        </nav>
    </div>
</header>

        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                <article class="post">
    <nav class="pager">
    <ul class="pagination">
        
        <li><a class="pagelink" href="../Untyped/">上一章</a></li>
        <li class="separator">&bullet;</li>
        
        
        <li><a class="pagelink" href="https://github.com/Agda-zh/PLFA-zh/blob/dev/src/plfa/part2/Confluence.lagda.md">源文件</a></li>
        <li class="separator">&bullet;</li>
        
        
        <li><a class="pagelink" href="../BigStep/">下一章</a></li>
        <li class="separator">&bullet;</li>
        
    </ul>
</nav>

    <header class="post-header">
        <h1 class="post-title" id="confluence">Confluence: 无类型 λ-演算的合流性</h1>
    </header>
    <div class="post-content">
        <pre class="Agda"><a id="187" class="Keyword">module</a> <a id="194" href="../Confluence/" class="Module">plfa.part2.Confluence</a> <a id="216" class="Keyword">where</a>
</pre>
<!--
## Introduction
-->
<h2 id="简介">简介</h2>
<!--
In this chapter we prove that beta reduction is _confluent_, a
property also known as _Church-Rosser_. That is, if there are
reduction sequences from any term `L` to two different terms `M₁` and
`M₂`, then there exist reduction sequences from those two terms to
some common term `N`. In pictures:
-->
<p>在这一章我们将证明 β-规约是<strong>合流的（Confluent）</strong> （又被称作 <em>Church-Rosser</em> 性质）： 如果有从任一项 <code>L</code> 至两个不同项 <code>M₁</code> 和 <code>M₂</code> 的规约序列， 那么一定存在从这两个项至某个相同项 <code>N</code> 的规约序列。 如图：</p>
<pre><code>    L
   / \
  /   \
 /     \
M₁      M₂
 \     /
  \   /
   \ /
    N</code></pre>
<!--
where downward lines are instances of `—↠`.
-->
<p>其中向下的线是 <code>-↠</code> 的实例。</p>
<!--
Confluence is studied in many other kinds of rewrite systems besides
the lambda calculus, and it is well known how to prove confluence in
rewrite systems that enjoy the _diamond property_, a single-step
version of confluence. Let `⇛` be a relation.  Then `⇛` has the
diamond property if whenever `L ⇛ M₁` and `L ⇛ M₂`, then there exists
an `N` such that `M₁ ⇛ N` and `M₂ ⇛ N`. This is just an instance of
the same picture above, where downward lines are now instance of `⇛`.
If we write `⇛*` for the reflexive and transitive closure of `⇛`, then
confluence of `⇛*` follows immediately from the diamond property.
-->
<p>合流性（Confluence）也在许多 λ-演算外的重写系统中被研究， 并且如何在满足<strong>菱形性质（Diamond Property）</strong>， 一种合流性的单步版本的重写系统中证明合流性是广为人知的。 令 <code>⇛</code> 为一个关系。<code>⇛</code> 具有菱形性质， 如果对于任何 <code>L ⇛ M₁</code> 和 <code>L ⇛ M₂</code> 都存在 <code>N</code> ， 使得 <code>M₁ ⇛ N</code> 和 <code>M₂ ⇛ N</code>。 这只是上图的另一个例子，此处向下的线代表 <code>⇛</code>。 如果我们将 <code>⇛</code> 的自反传递闭包写作 <code>⇛*</code>， 那么可以立即从菱形性质推出 <code>⇛*</code> 的合流性。</p>
<!--
Unfortunately, reduction in the lambda calculus does not satisfy the
diamond property. Here is a counter example.
-->
<p>不幸的是 λ-演算的规约并不满足菱形性质。这是一个反例：</p>
<pre><code>(λ x. x x)((λ x. x) a) —→ (λ x. x x) a
(λ x. x x)((λ x. x) a) —→ ((λ x. x) a) ((λ x. x) a)</code></pre>
<!--
Both terms can reduce to `a a`, but the second term requires two steps
to get there, not one.
-->
<p>两个项都可以规约至 <code>a a</code>，但第二项需要两步来完成，而不是一步。</p>
<!--
To side-step this problem, we'll define an auxiliary reduction
relation, called _parallel reduction_, that can perform many
reductions simultaneously and thereby satisfy the diamond property.
Furthermore, we show that a parallel reduction sequence exists between
any two terms if and only if a beta reduction sequence exists between them.
Thus, we can reduce the proof of confluence for beta reduction to
confluence for parallel reduction.
-->
<p>为了回避这个问题，我们将定义一个辅助规约关系， 称为<strong>平行规约（Parallel Reduction）</strong> ， 它可以同时执行许多规约并因此满足菱形性质。 更进一步地，我们将证明在两个项间存在平行规约序列当且仅当这两个项间存在 β-规约序列。 因此，我们可以将 β-规约序列合流性的证明约化为平行规约合流性的证明。</p>
<!--
## Imports
-->
<h2 id="导入">导入</h2>
<pre class="Agda"><a id="2802" class="Keyword">open</a> <a id="2807" class="Keyword">import</a> <a id="2814" href="https://agda.github.io/agda-stdlib/v1.3/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="2852" class="Keyword">using</a> <a id="2858" class="Symbol">(</a><a id="2859" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="2862" class="Symbol">;</a> <a id="2864" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2868" class="Symbol">)</a>
<a id="2870" class="Keyword">open</a> <a id="2875" class="Keyword">import</a> <a id="2882" href="https://agda.github.io/agda-stdlib/v1.3/Function.html" class="Module">Function</a> <a id="2891" class="Keyword">using</a> <a id="2897" class="Symbol">(</a><a id="2898" href="https://agda.github.io/agda-stdlib/v1.3/Function.Base.html#992" class="Function Operator">_∘_</a><a id="2901" class="Symbol">)</a>
<a id="2903" class="Keyword">open</a> <a id="2908" class="Keyword">import</a> <a id="2915" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html" class="Module">Data.Product</a> <a id="2928" class="Keyword">using</a> <a id="2934" class="Symbol">(</a><a id="2935" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">_×_</a><a id="2938" class="Symbol">;</a> <a id="2940" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Sigma.html#166" class="Record">Σ</a><a id="2941" class="Symbol">;</a> <a id="2943" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Σ-syntax</a><a id="2951" class="Symbol">;</a> <a id="2953" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1369" class="Function">∃</a><a id="2954" class="Symbol">;</a> <a id="2956" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1788" class="Function">∃-syntax</a><a id="2964" class="Symbol">;</a> <a id="2966" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="2971" class="Symbol">;</a> <a id="2973" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="2978" class="Symbol">)</a>
  <a id="2982" class="Keyword">renaming</a> <a id="2991" class="Symbol">(</a><a id="2992" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="2996" class="Symbol">to</a> <a id="_,_"></a><a id="2999" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="3004" class="Symbol">)</a>
<a id="3006" class="Keyword">open</a> <a id="3011" class="Keyword">import</a> <a id="3018" href="../Substitution/" class="Module">plfa.part2.Substitution</a> <a id="3042" class="Keyword">using</a> <a id="3048" class="Symbol">(</a><a id="3049" href="../Substitution/#2192" class="Function">Rename</a><a id="3055" class="Symbol">;</a> <a id="3057" href="../Substitution/#2405" class="Function">Subst</a><a id="3062" class="Symbol">)</a>
<a id="3064" class="Keyword">open</a> <a id="3069" class="Keyword">import</a> <a id="3076" href="../Untyped/" class="Module">plfa.part2.Untyped</a>
  <a id="3097" class="Keyword">using</a> <a id="3103" class="Symbol">(</a><a id="3104" href="../Untyped/#9930" class="Datatype Operator">_—→_</a><a id="3108" class="Symbol">;</a> <a id="3110" href="../Untyped/#10160" class="InductiveConstructor">β</a><a id="3111" class="Symbol">;</a> <a id="3113" href="../Untyped/#9980" class="InductiveConstructor">ξ₁</a><a id="3115" class="Symbol">;</a> <a id="3117" href="../Untyped/#10070" class="InductiveConstructor">ξ₂</a><a id="3119" class="Symbol">;</a> <a id="3121" href="../Untyped/#10268" class="InductiveConstructor">ζ</a><a id="3122" class="Symbol">;</a> <a id="3124" href="../Untyped/#11050" class="Datatype Operator">_—↠_</a><a id="3128" class="Symbol">;</a> <a id="3130" href="../Untyped/#11256" class="Function Operator">begin_</a><a id="3136" class="Symbol">;</a> <a id="3138" href="../Untyped/#11156" class="InductiveConstructor Operator">_—→⟨_⟩_</a><a id="3145" class="Symbol">;</a> <a id="3147" href="../Untyped/#21981" class="Function Operator">_—↠⟨_⟩_</a><a id="3154" class="Symbol">;</a> <a id="3156" href="../Untyped/#11100" class="InductiveConstructor Operator">_∎</a><a id="3158" class="Symbol">;</a>
  <a id="3162" href="../Untyped/#23874" class="Function">abs-cong</a><a id="3170" class="Symbol">;</a> <a id="3172" href="../Untyped/#22877" class="Function">appL-cong</a><a id="3181" class="Symbol">;</a> <a id="3183" href="../Untyped/#23646" class="Function">appR-cong</a><a id="3192" class="Symbol">;</a> <a id="3194" href="../Untyped/#21711" class="Function">—↠-trans</a><a id="3202" class="Symbol">;</a>
  <a id="3206" href="../Untyped/#4276" class="Datatype Operator">_⊢_</a><a id="3209" class="Symbol">;</a> <a id="3211" href="../Untyped/#3503" class="Datatype Operator">_∋_</a><a id="3214" class="Symbol">;</a> <a id="3216" href="../Untyped/#4312" class="InductiveConstructor Operator">`_</a><a id="3218" class="Symbol">;</a> <a id="3220" href="../Untyped/#5093" class="Function Operator">#_</a><a id="3222" class="Symbol">;</a> <a id="3224" href="../Untyped/#3173" class="InductiveConstructor Operator">_,_</a><a id="3227" class="Symbol">;</a> <a id="3229" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="3230" class="Symbol">;</a> <a id="3232" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ_</a><a id="3234" class="Symbol">;</a> <a id="3236" href="../Untyped/#4424" class="InductiveConstructor Operator">_·_</a><a id="3239" class="Symbol">;</a> <a id="3241" href="../Untyped/#7473" class="Function Operator">_[_]</a><a id="3245" class="Symbol">;</a>
  <a id="3249" href="../Untyped/#6217" class="Function">rename</a><a id="3255" class="Symbol">;</a> <a id="3257" href="../Untyped/#5907" class="Function">ext</a><a id="3260" class="Symbol">;</a> <a id="3262" href="../Untyped/#6653" class="Function">exts</a><a id="3266" class="Symbol">;</a> <a id="3268" href="../Untyped/#3539" class="InductiveConstructor">Z</a><a id="3269" class="Symbol">;</a> <a id="3271" href="../Untyped/#3584" class="InductiveConstructor Operator">S_</a><a id="3273" class="Symbol">;</a> <a id="3275" href="../Untyped/#6945" class="Function">subst</a><a id="3280" class="Symbol">;</a> <a id="3282" href="../Untyped/#7357" class="Function">subst-zero</a><a id="3292" class="Symbol">)</a>
</pre>
<!--
## Parallel Reduction
-->
<h2 id="平行规约">平行规约</h2>
<!--
The parallel reduction relation is defined as follows.
-->
<p>平行规约关系被定义如下。</p>
<pre class="Agda"><a id="3423" class="Keyword">infix</a> <a id="3429" class="Number">2</a> <a id="3431" href="../Confluence/#3441" class="Datatype Operator">_⇛_</a>

<a id="3436" class="Keyword">data</a> <a id="_⇛_"></a><a id="3441" href="../Confluence/#3441" class="Datatype Operator">_⇛_</a> <a id="3445" class="Symbol">:</a> <a id="3447" class="Symbol">∀</a> <a id="3449" class="Symbol">{</a><a id="3450" href="../Confluence/#3450" class="Bound">Γ</a> <a id="3452" href="../Confluence/#3452" class="Bound">A</a><a id="3453" class="Symbol">}</a> <a id="3455" class="Symbol">→</a> <a id="3457" class="Symbol">(</a><a id="3458" href="../Confluence/#3450" class="Bound">Γ</a> <a id="3460" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3462" href="../Confluence/#3452" class="Bound">A</a><a id="3463" class="Symbol">)</a> <a id="3465" class="Symbol">→</a> <a id="3467" class="Symbol">(</a><a id="3468" href="../Confluence/#3450" class="Bound">Γ</a> <a id="3470" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3472" href="../Confluence/#3452" class="Bound">A</a><a id="3473" class="Symbol">)</a> <a id="3475" class="Symbol">→</a> <a id="3477" class="PrimitiveType">Set</a> <a id="3481" class="Keyword">where</a>

  <a id="_⇛_.pvar"></a><a id="3490" href="../Confluence/#3490" class="InductiveConstructor">pvar</a> <a id="3495" class="Symbol">:</a> <a id="3497" class="Symbol">∀{</a><a id="3499" href="../Confluence/#3499" class="Bound">Γ</a> <a id="3501" href="../Confluence/#3501" class="Bound">A</a><a id="3502" class="Symbol">}{</a><a id="3504" href="../Confluence/#3504" class="Bound">x</a> <a id="3506" class="Symbol">:</a> <a id="3508" href="../Confluence/#3499" class="Bound">Γ</a> <a id="3510" href="../Untyped/#3503" class="Datatype Operator">∋</a> <a id="3512" href="../Confluence/#3501" class="Bound">A</a><a id="3513" class="Symbol">}</a>
      <a id="3521" class="Comment">---------</a>
    <a id="3535" class="Symbol">→</a> <a id="3537" class="Symbol">(</a><a id="3538" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="3540" href="../Confluence/#3504" class="Bound">x</a><a id="3541" class="Symbol">)</a> <a id="3543" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3545" class="Symbol">(</a><a id="3546" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="3548" href="../Confluence/#3504" class="Bound">x</a><a id="3549" class="Symbol">)</a>

  <a id="_⇛_.pabs"></a><a id="3554" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="3559" class="Symbol">:</a> <a id="3561" class="Symbol">∀{</a><a id="3563" href="../Confluence/#3563" class="Bound">Γ</a><a id="3564" class="Symbol">}{</a><a id="3566" href="../Confluence/#3566" class="Bound">N</a> <a id="3568" href="../Confluence/#3568" class="Bound">N′</a> <a id="3571" class="Symbol">:</a> <a id="3573" href="../Confluence/#3563" class="Bound">Γ</a> <a id="3575" href="../Untyped/#3173" class="InductiveConstructor Operator">,</a> <a id="3577" href="../Untyped/#2870" class="InductiveConstructor">★</a> <a id="3579" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3581" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="3582" class="Symbol">}</a>
    <a id="3588" class="Symbol">→</a> <a id="3590" href="../Confluence/#3566" class="Bound">N</a> <a id="3592" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3594" href="../Confluence/#3568" class="Bound">N′</a>
      <a id="3603" class="Comment">----------</a>
    <a id="3618" class="Symbol">→</a> <a id="3620" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="3622" href="../Confluence/#3566" class="Bound">N</a> <a id="3624" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3626" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="3628" href="../Confluence/#3568" class="Bound">N′</a>

  <a id="_⇛_.papp"></a><a id="3634" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="3639" class="Symbol">:</a> <a id="3641" class="Symbol">∀{</a><a id="3643" href="../Confluence/#3643" class="Bound">Γ</a><a id="3644" class="Symbol">}{</a><a id="3646" href="../Confluence/#3646" class="Bound">L</a> <a id="3648" href="../Confluence/#3648" class="Bound">L′</a> <a id="3651" href="../Confluence/#3651" class="Bound">M</a> <a id="3653" href="../Confluence/#3653" class="Bound">M′</a> <a id="3656" class="Symbol">:</a> <a id="3658" href="../Confluence/#3643" class="Bound">Γ</a> <a id="3660" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3662" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="3663" class="Symbol">}</a>
    <a id="3669" class="Symbol">→</a> <a id="3671" href="../Confluence/#3646" class="Bound">L</a> <a id="3673" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3675" href="../Confluence/#3648" class="Bound">L′</a>
    <a id="3682" class="Symbol">→</a> <a id="3684" href="../Confluence/#3651" class="Bound">M</a> <a id="3686" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3688" href="../Confluence/#3653" class="Bound">M′</a>
      <a id="3697" class="Comment">-----------------</a>
    <a id="3719" class="Symbol">→</a> <a id="3721" href="../Confluence/#3646" class="Bound">L</a> <a id="3723" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="3725" href="../Confluence/#3651" class="Bound">M</a> <a id="3727" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3729" href="../Confluence/#3648" class="Bound">L′</a> <a id="3732" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="3734" href="../Confluence/#3653" class="Bound">M′</a>

  <a id="_⇛_.pbeta"></a><a id="3740" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="3746" class="Symbol">:</a> <a id="3748" class="Symbol">∀{</a><a id="3750" href="../Confluence/#3750" class="Bound">Γ</a><a id="3751" class="Symbol">}{</a><a id="3753" href="../Confluence/#3753" class="Bound">N</a> <a id="3755" href="../Confluence/#3755" class="Bound">N′</a>  <a id="3759" class="Symbol">:</a> <a id="3761" href="../Confluence/#3750" class="Bound">Γ</a> <a id="3763" href="../Untyped/#3173" class="InductiveConstructor Operator">,</a> <a id="3765" href="../Untyped/#2870" class="InductiveConstructor">★</a> <a id="3767" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3769" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="3770" class="Symbol">}{</a><a id="3772" href="../Confluence/#3772" class="Bound">M</a> <a id="3774" href="../Confluence/#3774" class="Bound">M′</a> <a id="3777" class="Symbol">:</a> <a id="3779" href="../Confluence/#3750" class="Bound">Γ</a> <a id="3781" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="3783" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="3784" class="Symbol">}</a>
    <a id="3790" class="Symbol">→</a> <a id="3792" href="../Confluence/#3753" class="Bound">N</a> <a id="3794" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3796" href="../Confluence/#3755" class="Bound">N′</a>
    <a id="3803" class="Symbol">→</a> <a id="3805" href="../Confluence/#3772" class="Bound">M</a> <a id="3807" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="3809" href="../Confluence/#3774" class="Bound">M′</a>
      <a id="3818" class="Comment">-----------------------</a>
    <a id="3846" class="Symbol">→</a> <a id="3848" class="Symbol">(</a><a id="3849" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="3851" href="../Confluence/#3753" class="Bound">N</a><a id="3852" class="Symbol">)</a> <a id="3854" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="3856" href="../Confluence/#3772" class="Bound">M</a>  <a id="3859" href="../Confluence/#3441" class="Datatype Operator">⇛</a>  <a id="3862" href="../Confluence/#3755" class="Bound">N′</a> <a id="3865" href="../Untyped/#7473" class="Function Operator">[</a> <a id="3867" href="../Confluence/#3774" class="Bound">M′</a> <a id="3870" href="../Untyped/#7473" class="Function Operator">]</a>
</pre>
<!--
The first three rules are congruences that reduce each of their
parts simultaneously. The last rule reduces a lambda term and
term in parallel followed by a beta step.
-->
<p>前三种规则是同时规约每个部分的合同性。 最后一个规则平行地规约一个 λ-项和另一个项，接着是一步 β-规约。</p>
<!--
We remark that the `pabs`, `papp`, and `pbeta` rules perform reduction
on all their subexpressions simultaneously. Also, the `pabs` rule is
akin to the `ζ` rule and `pbeta` is akin to `β`.
-->
<p>我们注意到 <code>pabs</code>、<code>papp</code> 和 <code>pbeta</code> 规则同时对它们的所有子表达式执行归约。 此外，<code>pabs</code> 规则类似于 <code>ζ</code> 规则，<code>pbeta</code> 类似于 <code>β</code> 规则。</p>
<!--
Parallel reduction is reflexive.
-->
<p>平行规约是自反的。</p>
<pre class="Agda"><a id="par-refl"></a><a id="4462" href="../Confluence/#4462" class="Function">par-refl</a> <a id="4471" class="Symbol">:</a> <a id="4473" class="Symbol">∀{</a><a id="4475" href="../Confluence/#4475" class="Bound">Γ</a> <a id="4477" href="../Confluence/#4477" class="Bound">A</a><a id="4478" class="Symbol">}{</a><a id="4480" href="../Confluence/#4480" class="Bound">M</a> <a id="4482" class="Symbol">:</a> <a id="4484" href="../Confluence/#4475" class="Bound">Γ</a> <a id="4486" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4488" href="../Confluence/#4477" class="Bound">A</a><a id="4489" class="Symbol">}</a> <a id="4491" class="Symbol">→</a> <a id="4493" href="../Confluence/#4480" class="Bound">M</a> <a id="4495" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="4497" href="../Confluence/#4480" class="Bound">M</a>
<a id="4499" href="../Confluence/#4462" class="Function">par-refl</a> <a id="4508" class="Symbol">{</a><a id="4509" href="../Confluence/#4509" class="Bound">Γ</a><a id="4510" class="Symbol">}</a> <a id="4512" class="Symbol">{</a><a id="4513" href="../Confluence/#4513" class="Bound">A</a><a id="4514" class="Symbol">}</a> <a id="4516" class="Symbol">{</a><a id="4517" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="4519" href="../Confluence/#4519" class="Bound">x</a><a id="4520" class="Symbol">}</a> <a id="4522" class="Symbol">=</a> <a id="4524" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>
<a id="4529" href="../Confluence/#4462" class="Function">par-refl</a> <a id="4538" class="Symbol">{</a><a id="4539" href="../Confluence/#4539" class="Bound">Γ</a><a id="4540" class="Symbol">}</a> <a id="4542" class="Symbol">{</a><a id="4543" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="4544" class="Symbol">}</a> <a id="4546" class="Symbol">{</a><a id="4547" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="4549" href="../Confluence/#4549" class="Bound">N</a><a id="4550" class="Symbol">}</a> <a id="4552" class="Symbol">=</a> <a id="4554" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="4559" href="../Confluence/#4462" class="Function">par-refl</a>
<a id="4568" href="../Confluence/#4462" class="Function">par-refl</a> <a id="4577" class="Symbol">{</a><a id="4578" href="../Confluence/#4578" class="Bound">Γ</a><a id="4579" class="Symbol">}</a> <a id="4581" class="Symbol">{</a><a id="4582" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="4583" class="Symbol">}</a> <a id="4585" class="Symbol">{</a><a id="4586" href="../Confluence/#4586" class="Bound">L</a> <a id="4588" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="4590" href="../Confluence/#4590" class="Bound">M</a><a id="4591" class="Symbol">}</a> <a id="4593" class="Symbol">=</a> <a id="4595" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="4600" href="../Confluence/#4462" class="Function">par-refl</a> <a id="4609" href="../Confluence/#4462" class="Function">par-refl</a>
</pre>
<!--
We define the sequences of parallel reduction as follows.
-->
<p>我们定义平行规约序列如下。</p>
<pre class="Agda"><a id="4710" class="Keyword">infix</a>  <a id="4717" class="Number">2</a> <a id="4719" href="../Confluence/#4758" class="Datatype Operator">_⇛*_</a>
<a id="4724" class="Keyword">infixr</a> <a id="4731" class="Number">2</a> <a id="4733" href="../Confluence/#4864" class="InductiveConstructor Operator">_⇛⟨_⟩_</a>
<a id="4740" class="Keyword">infix</a>  <a id="4747" class="Number">3</a> <a id="4749" href="../Confluence/#4808" class="InductiveConstructor Operator">_∎</a>

<a id="4753" class="Keyword">data</a> <a id="_⇛*_"></a><a id="4758" href="../Confluence/#4758" class="Datatype Operator">_⇛*_</a> <a id="4763" class="Symbol">:</a> <a id="4765" class="Symbol">∀</a> <a id="4767" class="Symbol">{</a><a id="4768" href="../Confluence/#4768" class="Bound">Γ</a> <a id="4770" href="../Confluence/#4770" class="Bound">A</a><a id="4771" class="Symbol">}</a> <a id="4773" class="Symbol">→</a> <a id="4775" class="Symbol">(</a><a id="4776" href="../Confluence/#4768" class="Bound">Γ</a> <a id="4778" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4780" href="../Confluence/#4770" class="Bound">A</a><a id="4781" class="Symbol">)</a> <a id="4783" class="Symbol">→</a> <a id="4785" class="Symbol">(</a><a id="4786" href="../Confluence/#4768" class="Bound">Γ</a> <a id="4788" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4790" href="../Confluence/#4770" class="Bound">A</a><a id="4791" class="Symbol">)</a> <a id="4793" class="Symbol">→</a> <a id="4795" class="PrimitiveType">Set</a> <a id="4799" class="Keyword">where</a>

  <a id="_⇛*_._∎"></a><a id="4808" href="../Confluence/#4808" class="InductiveConstructor Operator">_∎</a> <a id="4811" class="Symbol">:</a> <a id="4813" class="Symbol">∀</a> <a id="4815" class="Symbol">{</a><a id="4816" href="../Confluence/#4816" class="Bound">Γ</a> <a id="4818" href="../Confluence/#4818" class="Bound">A</a><a id="4819" class="Symbol">}</a> <a id="4821" class="Symbol">(</a><a id="4822" href="../Confluence/#4822" class="Bound">M</a> <a id="4824" class="Symbol">:</a> <a id="4826" href="../Confluence/#4816" class="Bound">Γ</a> <a id="4828" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4830" href="../Confluence/#4818" class="Bound">A</a><a id="4831" class="Symbol">)</a>
      <a id="4839" class="Comment">--------</a>
    <a id="4852" class="Symbol">→</a> <a id="4854" href="../Confluence/#4822" class="Bound">M</a> <a id="4856" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="4859" href="../Confluence/#4822" class="Bound">M</a>

  <a id="_⇛*_._⇛⟨_⟩_"></a><a id="4864" href="../Confluence/#4864" class="InductiveConstructor Operator">_⇛⟨_⟩_</a> <a id="4871" class="Symbol">:</a> <a id="4873" class="Symbol">∀</a> <a id="4875" class="Symbol">{</a><a id="4876" href="../Confluence/#4876" class="Bound">Γ</a> <a id="4878" href="../Confluence/#4878" class="Bound">A</a><a id="4879" class="Symbol">}</a> <a id="4881" class="Symbol">(</a><a id="4882" href="../Confluence/#4882" class="Bound">L</a> <a id="4884" class="Symbol">:</a> <a id="4886" href="../Confluence/#4876" class="Bound">Γ</a> <a id="4888" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4890" href="../Confluence/#4878" class="Bound">A</a><a id="4891" class="Symbol">)</a> <a id="4893" class="Symbol">{</a><a id="4894" href="../Confluence/#4894" class="Bound">M</a> <a id="4896" href="../Confluence/#4896" class="Bound">N</a> <a id="4898" class="Symbol">:</a> <a id="4900" href="../Confluence/#4876" class="Bound">Γ</a> <a id="4902" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="4904" href="../Confluence/#4878" class="Bound">A</a><a id="4905" class="Symbol">}</a>
    <a id="4911" class="Symbol">→</a> <a id="4913" href="../Confluence/#4882" class="Bound">L</a> <a id="4915" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="4917" href="../Confluence/#4894" class="Bound">M</a>
    <a id="4923" class="Symbol">→</a> <a id="4925" href="../Confluence/#4894" class="Bound">M</a> <a id="4927" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="4930" href="../Confluence/#4896" class="Bound">N</a>
      <a id="4938" class="Comment">---------</a>
    <a id="4952" class="Symbol">→</a> <a id="4954" href="../Confluence/#4882" class="Bound">L</a> <a id="4956" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="4959" href="../Confluence/#4896" class="Bound">N</a>
</pre>
<!--
#### Exercise `par-diamond-eg` (practice)
-->
<h4 id="练习-par-diamond-eg实践">练习 <code>par-diamond-eg</code>（实践）</h4>
<!--
Revisit the counter example to the diamond property for reduction by
showing that the diamond property holds for parallel reduction in that
case.
-->
<p>回顾上文中菱形性质的反例，证明在这种情况下平行规约具有菱形性质。</p>
<!--
<pre class="Agda"><a id="5248" class="Comment">-- Your code goes here</a>
</pre>-->
<pre class="Agda"><a id="5284" class="Comment">-- 请将代码写在此处。</a>
</pre>
<!--
## Equivalence between parallel reduction and reduction
-->
<h2 id="平行规约与规约间等价性">平行规约与规约间等价性</h2>
<!--
Here we prove that for any `M` and `N`, `M ⇛* N` if and only if `M —↠ N`.
The only-if direction is particularly easy. We start by showing
that if `M —→ N`, then `M ⇛ N`. The proof is by induction on
the reduction `M —→ N`.
-->
<p>此处我们证明对于任何 <code>M</code> 和 <code>N</code>，<code>M ⇛* N</code> 当且仅当 <code>M —↠ N</code>。 必要性的证明非常容易，我们开始于说明若 <code>M —→ N</code>，则 <code>M ⇛ N</code>。 该证明通过对规约 <code>M —→ N</code> 进行归纳。</p>
<pre class="Agda"><a id="beta-par"></a><a id="5732" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5741" class="Symbol">:</a> <a id="5743" class="Symbol">∀{</a><a id="5745" href="../Confluence/#5745" class="Bound">Γ</a> <a id="5747" href="../Confluence/#5747" class="Bound">A</a><a id="5748" class="Symbol">}{</a><a id="5750" href="../Confluence/#5750" class="Bound">M</a> <a id="5752" href="../Confluence/#5752" class="Bound">N</a> <a id="5754" class="Symbol">:</a> <a id="5756" href="../Confluence/#5745" class="Bound">Γ</a> <a id="5758" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="5760" href="../Confluence/#5747" class="Bound">A</a><a id="5761" class="Symbol">}</a>
  <a id="5765" class="Symbol">→</a> <a id="5767" href="../Confluence/#5750" class="Bound">M</a> <a id="5769" href="../Untyped/#9930" class="Datatype Operator">—→</a> <a id="5772" href="../Confluence/#5752" class="Bound">N</a>
    <a id="5778" class="Comment">------</a>
  <a id="5787" class="Symbol">→</a> <a id="5789" href="../Confluence/#5750" class="Bound">M</a> <a id="5791" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="5793" href="../Confluence/#5752" class="Bound">N</a>
<a id="5795" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5804" class="Symbol">{</a><a id="5805" href="../Confluence/#5805" class="Bound">Γ</a><a id="5806" class="Symbol">}</a> <a id="5808" class="Symbol">{</a><a id="5809" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="5810" class="Symbol">}</a> <a id="5812" class="Symbol">{</a><a id="5813" href="../Confluence/#5813" class="Bound">L</a> <a id="5815" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="5817" href="../Confluence/#5817" class="Bound">M</a><a id="5818" class="Symbol">}</a> <a id="5820" class="Symbol">(</a><a id="5821" href="../Untyped/#9980" class="InductiveConstructor">ξ₁</a> <a id="5824" href="../Confluence/#5824" class="Bound">r</a><a id="5825" class="Symbol">)</a> <a id="5827" class="Symbol">=</a> <a id="5829" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="5834" class="Symbol">(</a><a id="5835" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5844" class="Symbol">{</a><a id="5845" class="Argument">M</a> <a id="5847" class="Symbol">=</a> <a id="5849" href="../Confluence/#5813" class="Bound">L</a><a id="5850" class="Symbol">}</a> <a id="5852" href="../Confluence/#5824" class="Bound">r</a><a id="5853" class="Symbol">)</a> <a id="5855" href="../Confluence/#4462" class="Function">par-refl</a>
<a id="5864" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5873" class="Symbol">{</a><a id="5874" href="../Confluence/#5874" class="Bound">Γ</a><a id="5875" class="Symbol">}</a> <a id="5877" class="Symbol">{</a><a id="5878" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="5879" class="Symbol">}</a> <a id="5881" class="Symbol">{</a><a id="5882" href="../Confluence/#5882" class="Bound">L</a> <a id="5884" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="5886" href="../Confluence/#5886" class="Bound">M</a><a id="5887" class="Symbol">}</a> <a id="5889" class="Symbol">(</a><a id="5890" href="../Untyped/#10070" class="InductiveConstructor">ξ₂</a> <a id="5893" href="../Confluence/#5893" class="Bound">r</a><a id="5894" class="Symbol">)</a> <a id="5896" class="Symbol">=</a> <a id="5898" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="5903" href="../Confluence/#4462" class="Function">par-refl</a> <a id="5912" class="Symbol">(</a><a id="5913" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5922" class="Symbol">{</a><a id="5923" class="Argument">M</a> <a id="5925" class="Symbol">=</a> <a id="5927" href="../Confluence/#5886" class="Bound">M</a><a id="5928" class="Symbol">}</a> <a id="5930" href="../Confluence/#5893" class="Bound">r</a><a id="5931" class="Symbol">)</a>
<a id="5933" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5942" class="Symbol">{</a><a id="5943" href="../Confluence/#5943" class="Bound">Γ</a><a id="5944" class="Symbol">}</a> <a id="5946" class="Symbol">{</a><a id="5947" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="5948" class="Symbol">}</a> <a id="5950" class="Symbol">{(</a><a id="5952" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="5954" href="../Confluence/#5954" class="Bound">N</a><a id="5955" class="Symbol">)</a> <a id="5957" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="5959" href="../Confluence/#5959" class="Bound">M</a><a id="5960" class="Symbol">}</a> <a id="5962" href="../Untyped/#10160" class="InductiveConstructor">β</a> <a id="5964" class="Symbol">=</a> <a id="5966" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="5972" href="../Confluence/#4462" class="Function">par-refl</a> <a id="5981" href="../Confluence/#4462" class="Function">par-refl</a>
<a id="5990" href="../Confluence/#5732" class="Function">beta-par</a> <a id="5999" class="Symbol">{</a><a id="6000" href="../Confluence/#6000" class="Bound">Γ</a><a id="6001" class="Symbol">}</a> <a id="6003" class="Symbol">{</a><a id="6004" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="6005" class="Symbol">}</a> <a id="6007" class="Symbol">{</a><a id="6008" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="6010" href="../Confluence/#6010" class="Bound">N</a><a id="6011" class="Symbol">}</a> <a id="6013" class="Symbol">(</a><a id="6014" href="../Untyped/#10268" class="InductiveConstructor">ζ</a> <a id="6016" href="../Confluence/#6016" class="Bound">r</a><a id="6017" class="Symbol">)</a> <a id="6019" class="Symbol">=</a> <a id="6021" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="6026" class="Symbol">(</a><a id="6027" href="../Confluence/#5732" class="Function">beta-par</a> <a id="6036" href="../Confluence/#6016" class="Bound">r</a><a id="6037" class="Symbol">)</a>
</pre>
<!--
With this lemma in hand we complete the only-if direction,
that `M —↠ N` implies `M ⇛* N`. The proof is a straightforward
induction on the reduction sequence `M —↠ N`.
-->
<p>证明了该引理后我们便可完成必要性的证明， 即 <code>M —↠ N</code> 蕴含 <code>M ⇛* N</code>。该证明是对 <code>M —↠ N</code> 规约序列的简单归纳。</p>
<pre class="Agda"><a id="betas-pars"></a><a id="6297" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="6308" class="Symbol">:</a> <a id="6310" class="Symbol">∀{</a><a id="6312" href="../Confluence/#6312" class="Bound">Γ</a> <a id="6314" href="../Confluence/#6314" class="Bound">A</a><a id="6315" class="Symbol">}</a> <a id="6317" class="Symbol">{</a><a id="6318" href="../Confluence/#6318" class="Bound">M</a> <a id="6320" href="../Confluence/#6320" class="Bound">N</a> <a id="6322" class="Symbol">:</a> <a id="6324" href="../Confluence/#6312" class="Bound">Γ</a> <a id="6326" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="6328" href="../Confluence/#6314" class="Bound">A</a><a id="6329" class="Symbol">}</a>
  <a id="6333" class="Symbol">→</a> <a id="6335" href="../Confluence/#6318" class="Bound">M</a> <a id="6337" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="6340" href="../Confluence/#6320" class="Bound">N</a>
    <a id="6346" class="Comment">------</a>
  <a id="6355" class="Symbol">→</a> <a id="6357" href="../Confluence/#6318" class="Bound">M</a> <a id="6359" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="6362" href="../Confluence/#6320" class="Bound">N</a>
<a id="6364" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="6375" class="Symbol">{</a><a id="6376" href="../Confluence/#6376" class="Bound">Γ</a><a id="6377" class="Symbol">}</a> <a id="6379" class="Symbol">{</a><a id="6380" href="../Confluence/#6380" class="Bound">A</a><a id="6381" class="Symbol">}</a> <a id="6383" class="Symbol">{</a><a id="6384" href="../Confluence/#6384" class="Bound">M₁</a><a id="6386" class="Symbol">}</a> <a id="6388" class="Symbol">{</a><a id="6389" class="DottedPattern Symbol">.</a><a id="6390" href="../Confluence/#6384" class="DottedPattern Bound">M₁</a><a id="6392" class="Symbol">}</a> <a id="6394" class="Symbol">(</a><a id="6395" href="../Confluence/#6384" class="Bound">M₁</a> <a id="6398" href="../Untyped/#11100" class="InductiveConstructor Operator">∎</a><a id="6399" class="Symbol">)</a> <a id="6401" class="Symbol">=</a> <a id="6403" href="../Confluence/#6384" class="Bound">M₁</a> <a id="6406" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a>
<a id="6408" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="6419" class="Symbol">{</a><a id="6420" href="../Confluence/#6420" class="Bound">Γ</a><a id="6421" class="Symbol">}</a> <a id="6423" class="Symbol">{</a><a id="6424" href="../Confluence/#6424" class="Bound">A</a><a id="6425" class="Symbol">}</a> <a id="6427" class="Symbol">{</a><a id="6428" class="DottedPattern Symbol">.</a><a id="6429" href="../Confluence/#6437" class="DottedPattern Bound">L</a><a id="6430" class="Symbol">}</a> <a id="6432" class="Symbol">{</a><a id="6433" href="../Confluence/#6433" class="Bound">N</a><a id="6434" class="Symbol">}</a> <a id="6436" class="Symbol">(</a><a id="6437" href="../Confluence/#6437" class="Bound">L</a> <a id="6439" href="../Untyped/#11156" class="InductiveConstructor Operator">—→⟨</a> <a id="6443" href="../Confluence/#6443" class="Bound">b</a> <a id="6445" href="../Untyped/#11156" class="InductiveConstructor Operator">⟩</a> <a id="6447" href="../Confluence/#6447" class="Bound">bs</a><a id="6449" class="Symbol">)</a> <a id="6451" class="Symbol">=</a>
   <a id="6456" href="../Confluence/#6437" class="Bound">L</a> <a id="6458" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="6461" href="../Confluence/#5732" class="Function">beta-par</a> <a id="6470" href="../Confluence/#6443" class="Bound">b</a> <a id="6472" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="6474" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="6485" href="../Confluence/#6447" class="Bound">bs</a>
</pre>
<!--
Now for the other direction, that `M ⇛* N` implies `M —↠ N`.  The
proof of this direction is a bit different because it's not the case
that `M ⇛ N` implies `M —→ N`. After all, `M ⇛ N` performs many
reductions. So instead we shall prove that `M ⇛ N` implies `M —↠ N`.
-->
<p>现在考虑命题的充分性，即 <code>M ⇛* N</code> 蕴含 <code>M —↠ N</code>。 充分性的证明有一点不同，因为它不是 <code>M ⇛ N</code> 蕴含 <code>M —→ N</code> 的情形。 毕竟 <code>M ⇛ N</code> 执行了许多规约， 所以我们应当证明 <code>M ⇛ N</code> 蕴含 <code>M —↠ N</code>。</p>
<pre class="Agda"><a id="par-betas"></a><a id="6904" href="../Confluence/#6904" class="Function">par-betas</a> <a id="6914" class="Symbol">:</a> <a id="6916" class="Symbol">∀{</a><a id="6918" href="../Confluence/#6918" class="Bound">Γ</a> <a id="6920" href="../Confluence/#6920" class="Bound">A</a><a id="6921" class="Symbol">}{</a><a id="6923" href="../Confluence/#6923" class="Bound">M</a> <a id="6925" href="../Confluence/#6925" class="Bound">N</a> <a id="6927" class="Symbol">:</a> <a id="6929" href="../Confluence/#6918" class="Bound">Γ</a> <a id="6931" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="6933" href="../Confluence/#6920" class="Bound">A</a><a id="6934" class="Symbol">}</a>
  <a id="6938" class="Symbol">→</a> <a id="6940" href="../Confluence/#6923" class="Bound">M</a> <a id="6942" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="6944" href="../Confluence/#6925" class="Bound">N</a>
    <a id="6950" class="Comment">------</a>
  <a id="6959" class="Symbol">→</a> <a id="6961" href="../Confluence/#6923" class="Bound">M</a> <a id="6963" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="6966" href="../Confluence/#6925" class="Bound">N</a>
<a id="6968" href="../Confluence/#6904" class="Function">par-betas</a> <a id="6978" class="Symbol">{</a><a id="6979" href="../Confluence/#6979" class="Bound">Γ</a><a id="6980" class="Symbol">}</a> <a id="6982" class="Symbol">{</a><a id="6983" href="../Confluence/#6983" class="Bound">A</a><a id="6984" class="Symbol">}</a> <a id="6986" class="Symbol">{</a><a id="6987" class="DottedPattern Symbol">.(</a><a id="6989" href="../Untyped/#4312" class="DottedPattern InductiveConstructor Operator">`</a> <a id="6991" class="DottedPattern Symbol">_)</a><a id="6993" class="Symbol">}</a> <a id="6995" class="Symbol">(</a><a id="6996" href="../Confluence/#3490" class="InductiveConstructor">pvar</a><a id="7000" class="Symbol">{</a><a id="7001" class="Argument">x</a> <a id="7003" class="Symbol">=</a> <a id="7005" href="../Confluence/#7005" class="Bound">x</a><a id="7006" class="Symbol">})</a> <a id="7009" class="Symbol">=</a> <a id="7011" class="Symbol">(</a><a id="7012" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="7014" href="../Confluence/#7005" class="Bound">x</a><a id="7015" class="Symbol">)</a> <a id="7017" href="../Untyped/#11100" class="InductiveConstructor Operator">∎</a>
<a id="7019" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7029" class="Symbol">{</a><a id="7030" href="../Confluence/#7030" class="Bound">Γ</a><a id="7031" class="Symbol">}</a> <a id="7033" class="Symbol">{</a><a id="7034" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="7035" class="Symbol">}</a> <a id="7037" class="Symbol">{</a><a id="7038" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7040" href="../Confluence/#7040" class="Bound">N</a><a id="7041" class="Symbol">}</a> <a id="7043" class="Symbol">(</a><a id="7044" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="7049" href="../Confluence/#7049" class="Bound">p</a><a id="7050" class="Symbol">)</a> <a id="7052" class="Symbol">=</a> <a id="7054" href="../Untyped/#23874" class="Function">abs-cong</a> <a id="7063" class="Symbol">(</a><a id="7064" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7074" href="../Confluence/#7049" class="Bound">p</a><a id="7075" class="Symbol">)</a>
<a id="7077" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7087" class="Symbol">{</a><a id="7088" href="../Confluence/#7088" class="Bound">Γ</a><a id="7089" class="Symbol">}</a> <a id="7091" class="Symbol">{</a><a id="7092" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="7093" class="Symbol">}</a> <a id="7095" class="Symbol">{</a><a id="7096" href="../Confluence/#7096" class="Bound">L</a> <a id="7098" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7100" href="../Confluence/#7100" class="Bound">M</a><a id="7101" class="Symbol">}</a> <a id="7103" class="Symbol">(</a><a id="7104" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="7109" class="Symbol">{</a><a id="7110" class="Argument">L</a> <a id="7112" class="Symbol">=</a> <a id="7114" href="../Confluence/#7096" class="Bound">L</a><a id="7115" class="Symbol">}{</a><a id="7117" href="../Confluence/#7117" class="Bound">L′</a><a id="7119" class="Symbol">}{</a><a id="7121" href="../Confluence/#7100" class="Bound">M</a><a id="7122" class="Symbol">}{</a><a id="7124" href="../Confluence/#7124" class="Bound">M′</a><a id="7126" class="Symbol">}</a> <a id="7128" href="../Confluence/#7128" class="Bound">p₁</a> <a id="7131" href="../Confluence/#7131" class="Bound">p₂</a><a id="7133" class="Symbol">)</a> <a id="7135" class="Symbol">=</a>
    <a id="7141" href="../Untyped/#11256" class="Function Operator">begin</a>
    <a id="7151" href="../Confluence/#7096" class="Bound">L</a> <a id="7153" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7155" href="../Confluence/#7100" class="Bound">M</a>   <a id="7159" href="../Untyped/#21981" class="Function Operator">—↠⟨</a> <a id="7163" href="../Untyped/#22877" class="Function">appL-cong</a><a id="7172" class="Symbol">{</a><a id="7173" class="Argument">M</a> <a id="7175" class="Symbol">=</a> <a id="7177" href="../Confluence/#7100" class="Bound">M</a><a id="7178" class="Symbol">}</a> <a id="7180" class="Symbol">(</a><a id="7181" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7191" href="../Confluence/#7128" class="Bound">p₁</a><a id="7193" class="Symbol">)</a> <a id="7195" href="../Untyped/#21981" class="Function Operator">⟩</a>
    <a id="7201" href="../Confluence/#7117" class="Bound">L′</a> <a id="7204" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7206" href="../Confluence/#7100" class="Bound">M</a>  <a id="7209" href="../Untyped/#21981" class="Function Operator">—↠⟨</a> <a id="7213" href="../Untyped/#23646" class="Function">appR-cong</a> <a id="7223" class="Symbol">(</a><a id="7224" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7234" href="../Confluence/#7131" class="Bound">p₂</a><a id="7236" class="Symbol">)</a> <a id="7238" href="../Untyped/#21981" class="Function Operator">⟩</a>
    <a id="7244" href="../Confluence/#7117" class="Bound">L′</a> <a id="7247" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7249" href="../Confluence/#7124" class="Bound">M′</a>
    <a id="7256" href="../Untyped/#11100" class="InductiveConstructor Operator">∎</a>
<a id="7258" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7268" class="Symbol">{</a><a id="7269" href="../Confluence/#7269" class="Bound">Γ</a><a id="7270" class="Symbol">}</a> <a id="7272" class="Symbol">{</a><a id="7273" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="7274" class="Symbol">}</a> <a id="7276" class="Symbol">{(</a><a id="7278" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7280" href="../Confluence/#7280" class="Bound">N</a><a id="7281" class="Symbol">)</a> <a id="7283" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7285" href="../Confluence/#7285" class="Bound">M</a><a id="7286" class="Symbol">}</a> <a id="7288" class="Symbol">(</a><a id="7289" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a><a id="7294" class="Symbol">{</a><a id="7295" class="Argument">N′</a> <a id="7298" class="Symbol">=</a> <a id="7300" href="../Confluence/#7300" class="Bound">N′</a><a id="7302" class="Symbol">}{</a><a id="7304" class="Argument">M′</a> <a id="7307" class="Symbol">=</a> <a id="7309" href="../Confluence/#7309" class="Bound">M′</a><a id="7311" class="Symbol">}</a> <a id="7313" href="../Confluence/#7313" class="Bound">p₁</a> <a id="7316" href="../Confluence/#7316" class="Bound">p₂</a><a id="7318" class="Symbol">)</a> <a id="7320" class="Symbol">=</a>
    <a id="7326" href="../Untyped/#11256" class="Function Operator">begin</a>
    <a id="7336" class="Symbol">(</a><a id="7337" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7339" href="../Confluence/#7280" class="Bound">N</a><a id="7340" class="Symbol">)</a> <a id="7342" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7344" href="../Confluence/#7285" class="Bound">M</a>                    <a id="7365" href="../Untyped/#21981" class="Function Operator">—↠⟨</a> <a id="7369" href="../Untyped/#22877" class="Function">appL-cong</a><a id="7378" class="Symbol">{</a><a id="7379" class="Argument">M</a> <a id="7381" class="Symbol">=</a> <a id="7383" href="../Confluence/#7285" class="Bound">M</a><a id="7384" class="Symbol">}</a> <a id="7386" class="Symbol">(</a><a id="7387" href="../Untyped/#23874" class="Function">abs-cong</a> <a id="7396" class="Symbol">(</a><a id="7397" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7407" href="../Confluence/#7313" class="Bound">p₁</a><a id="7409" class="Symbol">))</a> <a id="7412" href="../Untyped/#21981" class="Function Operator">⟩</a>
    <a id="7418" class="Symbol">(</a><a id="7419" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7421" href="../Confluence/#7300" class="Bound">N′</a><a id="7423" class="Symbol">)</a> <a id="7425" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7427" href="../Confluence/#7285" class="Bound">M</a>                   <a id="7447" href="../Untyped/#21981" class="Function Operator">—↠⟨</a> <a id="7451" href="../Untyped/#23646" class="Function">appR-cong</a><a id="7460" class="Symbol">{</a><a id="7461" class="Argument">L</a> <a id="7463" class="Symbol">=</a> <a id="7465" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7467" href="../Confluence/#7300" class="Bound">N′</a><a id="7469" class="Symbol">}</a> <a id="7471" class="Symbol">(</a><a id="7472" href="../Confluence/#6904" class="Function">par-betas</a> <a id="7482" href="../Confluence/#7316" class="Bound">p₂</a><a id="7484" class="Symbol">)</a>  <a id="7487" href="../Untyped/#21981" class="Function Operator">⟩</a>
    <a id="7493" class="Symbol">(</a><a id="7494" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="7496" href="../Confluence/#7300" class="Bound">N′</a><a id="7498" class="Symbol">)</a> <a id="7500" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="7502" href="../Confluence/#7309" class="Bound">M′</a>                  <a id="7522" href="../Untyped/#11156" class="InductiveConstructor Operator">—→⟨</a> <a id="7526" href="../Untyped/#10160" class="InductiveConstructor">β</a> <a id="7528" href="../Untyped/#11156" class="InductiveConstructor Operator">⟩</a>
     <a id="7535" href="../Confluence/#7300" class="Bound">N′</a> <a id="7538" href="../Untyped/#7473" class="Function Operator">[</a> <a id="7540" href="../Confluence/#7309" class="Bound">M′</a> <a id="7543" href="../Untyped/#7473" class="Function Operator">]</a>
    <a id="7549" href="../Untyped/#11100" class="InductiveConstructor Operator">∎</a>
</pre>
<!--
The proof is by induction on `M ⇛ N`.
-->
<p>该证明通过对 <code>M ⇛ N</code> 进行归纳。</p>
<!--
* Suppose `x ⇛ x`. We immediately have `x —↠ x`.

* Suppose `ƛ N ⇛ ƛ N′` because `N ⇛ N′`. By the induction hypothesis
  we have `N —↠ N′`. We conclude that `ƛ N —↠ ƛ N′` because
  `—↠` is a congruence.

* Suppose `L · M ⇛ L′ · M′` because `L ⇛ L′` and `M ⇛ M′`.
  By the induction hypothesis, we have `L —↠ L′` and `M —↠ M′`.
  So `L · M —↠ L′ · M` and then `L′ · M  —↠ L′ · M′`
  because `—↠` is a congruence.

* Suppose `(ƛ N) · M  ⇛  N′ [ M′ ]` because `N ⇛ N′` and `M ⇛ M′`.
  By similar reasoning, we have
  `(ƛ N) · M —↠ (ƛ N′) · M′`
  which we can following with the β reduction
  `(ƛ N′) · M′ —→ N′ [ M′ ]`.
-->
<ul>
<li><p>假定 <code>x ⇛ x</code>。我们立刻有 <code>x —↠ x</code>。</p></li>
<li><p>假定 <code>ƛ N ⇛ ƛ N′</code> 因为 <code>N ⇛ N′</code>。根据归纳假设我们有 <code>N —↠ N′</code>。 我们得出 <code>ƛ N —↠ ƛ N′</code> 因为 <code>—↠</code> 具有合同性。</p></li>
<li><p>假定 <code>L · M ⇛ L′ · M′</code> 因为 <code>L ⇛ L′</code> 和 <code>M ⇛ M′</code>。 根据归纳假设，我们有 <code>L —↠ L′</code> 和 <code>M —↠ M′</code>。 所以有 <code>L · M —↠ L′ · M</code> 以及 <code>L′ · M  —↠ L′ · M′</code> 因为 <code>—↠</code> 具有合同性。</p></li>
<li><p>假定 <code>(ƛ N) · M  ⇛  N′ [ M′ ]</code> 因为 <code>N ⇛ N′</code> 和 <code>M ⇛ M′</code>。 根据类似的原因，我们有 <code>(ƛ N) · M —↠ (ƛ N′) · M′</code>， 接着应用 β-规约我们得到 <code>(ƛ N′) · M′ —→ N′ [ M′ ]</code>。</p></li>
</ul>
<!--
With this lemma in hand, we complete the proof that `M ⇛* N` implies
`M —↠ N` with a simple induction on `M ⇛* N`.
-->
<p>证明了该引理后我们便可通过对 <code>M ⇛* N</code> 的一步简单归纳完成 <code>M ⇛* N</code> 蕴含 <code>M —↠ N</code> 的证明。</p>
<pre class="Agda"><a id="pars-betas"></a><a id="8852" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="8863" class="Symbol">:</a> <a id="8865" class="Symbol">∀{</a><a id="8867" href="../Confluence/#8867" class="Bound">Γ</a> <a id="8869" href="../Confluence/#8869" class="Bound">A</a><a id="8870" class="Symbol">}</a> <a id="8872" class="Symbol">{</a><a id="8873" href="../Confluence/#8873" class="Bound">M</a> <a id="8875" href="../Confluence/#8875" class="Bound">N</a> <a id="8877" class="Symbol">:</a> <a id="8879" href="../Confluence/#8867" class="Bound">Γ</a> <a id="8881" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="8883" href="../Confluence/#8869" class="Bound">A</a><a id="8884" class="Symbol">}</a>
  <a id="8888" class="Symbol">→</a> <a id="8890" href="../Confluence/#8873" class="Bound">M</a> <a id="8892" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="8895" href="../Confluence/#8875" class="Bound">N</a>
    <a id="8901" class="Comment">------</a>
  <a id="8910" class="Symbol">→</a> <a id="8912" href="../Confluence/#8873" class="Bound">M</a> <a id="8914" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="8917" href="../Confluence/#8875" class="Bound">N</a>
<a id="8919" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="8930" class="Symbol">(</a><a id="8931" href="../Confluence/#8931" class="Bound">M₁</a> <a id="8934" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a><a id="8935" class="Symbol">)</a> <a id="8937" class="Symbol">=</a> <a id="8939" href="../Confluence/#8931" class="Bound">M₁</a> <a id="8942" href="../Untyped/#11100" class="InductiveConstructor Operator">∎</a>
<a id="8944" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="8955" class="Symbol">(</a><a id="8956" href="../Confluence/#8956" class="Bound">L</a> <a id="8958" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="8961" href="../Confluence/#8961" class="Bound">p</a> <a id="8963" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="8965" href="../Confluence/#8965" class="Bound">ps</a><a id="8967" class="Symbol">)</a> <a id="8969" class="Symbol">=</a> <a id="8971" href="../Untyped/#21711" class="Function">—↠-trans</a> <a id="8980" class="Symbol">(</a><a id="8981" href="../Confluence/#6904" class="Function">par-betas</a> <a id="8991" href="../Confluence/#8961" class="Bound">p</a><a id="8992" class="Symbol">)</a> <a id="8994" class="Symbol">(</a><a id="8995" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="9006" href="../Confluence/#8965" class="Bound">ps</a><a id="9008" class="Symbol">)</a>
</pre>
<!--
## Substitution lemma for parallel reduction
-->
<h2 id="平行规约的替换引理">平行规约的替换引理</h2>
<!--
Our next goal is to prove the diamond property for parallel
reduction. But to do that, we need to prove that substitution
respects parallel reduction. That is, if
`N ⇛ N′` and `M ⇛ M′`, then `N [ M ] ⇛ N′ [ M′ ]`.
We cannot prove this directly by induction, so we
generalize it to: if `N ⇛ N′` and
the substitution `σ` pointwise parallel reduces to `τ`,
then `subst σ N ⇛ subst τ N′`. We define the notion
of pointwise parallel reduction as follows.
-->
<p>我们的下一个目标是对平行规约证明菱形性质。 为了完成该证明，我们还需证明替换遵从平行规约。 也就是说，如果有 <code>N ⇛ N′</code> 和 <code>M ⇛ M′</code>，那么 <code>N [ M ] ⇛ N′ [ M′ ]</code>。 我们不能直接通过归纳证明它，所以我们将其推广为： 如果 <code>N ⇛ N′</code> 并且替换 <code>σ</code> 逐点（Pointwise）平行规约至 <code>τ</code>， 则 <code>subst σ N ⇛ subst τ N′</code>。 我们如下定义逐点平行规约。</p>
<pre class="Agda"><a id="par-subst"></a><a id="9763" href="../Confluence/#9763" class="Function">par-subst</a> <a id="9773" class="Symbol">:</a> <a id="9775" class="Symbol">∀{</a><a id="9777" href="../Confluence/#9777" class="Bound">Γ</a> <a id="9779" href="../Confluence/#9779" class="Bound">Δ</a><a id="9780" class="Symbol">}</a> <a id="9782" class="Symbol">→</a> <a id="9784" href="../Substitution/#2405" class="Function">Subst</a> <a id="9790" href="../Confluence/#9777" class="Bound">Γ</a> <a id="9792" href="../Confluence/#9779" class="Bound">Δ</a> <a id="9794" class="Symbol">→</a> <a id="9796" href="../Substitution/#2405" class="Function">Subst</a> <a id="9802" href="../Confluence/#9777" class="Bound">Γ</a> <a id="9804" href="../Confluence/#9779" class="Bound">Δ</a> <a id="9806" class="Symbol">→</a> <a id="9808" class="PrimitiveType">Set</a>
<a id="9812" href="../Confluence/#9763" class="Function">par-subst</a> <a id="9822" class="Symbol">{</a><a id="9823" href="../Confluence/#9823" class="Bound">Γ</a><a id="9824" class="Symbol">}{</a><a id="9826" href="../Confluence/#9826" class="Bound">Δ</a><a id="9827" class="Symbol">}</a> <a id="9829" href="../Confluence/#9829" class="Bound">σ</a> <a id="9831" href="../Confluence/#9831" class="Bound">σ′</a> <a id="9834" class="Symbol">=</a> <a id="9836" class="Symbol">∀{</a><a id="9838" href="../Confluence/#9838" class="Bound">A</a><a id="9839" class="Symbol">}{</a><a id="9841" href="../Confluence/#9841" class="Bound">x</a> <a id="9843" class="Symbol">:</a> <a id="9845" href="../Confluence/#9823" class="Bound">Γ</a> <a id="9847" href="../Untyped/#3503" class="Datatype Operator">∋</a> <a id="9849" href="../Confluence/#9838" class="Bound">A</a><a id="9850" class="Symbol">}</a> <a id="9852" class="Symbol">→</a> <a id="9854" href="../Confluence/#9829" class="Bound">σ</a> <a id="9856" href="../Confluence/#9841" class="Bound">x</a> <a id="9858" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="9860" href="../Confluence/#9831" class="Bound">σ′</a> <a id="9863" href="../Confluence/#9841" class="Bound">x</a>
</pre>
<!--
Because substitution depends on the extension function `exts`, which
in turn relies on `rename`, we start with a version of the
substitution lemma, called `par-rename`, that is specialized to
renamings.  The proof of `par-rename` relies on the fact that renaming
and substitution commute with one another, which is a lemma that we
import from Chapter [Substitution](/Substitution/)
and restate here.
-->
<p>因为替换依赖于扩展函数 <code>exts</code>，而其又依赖于 <code>rename</code>， 我们开始于被称为 <code>par-rename</code> 的替换引理的一种版本，该引理专门用于重命名。 <code>par-rename</code> 依赖于重命名和替换可以相互交换的事实， 这是一个我们在 <a href="../Substitution/">Substitution</a> 章节引入并在此处重申的引理。</p>
<pre class="Agda"><a id="rename-subst-commute"></a><a id="10453" href="../Confluence/#10453" class="Function">rename-subst-commute</a> <a id="10474" class="Symbol">:</a> <a id="10476" class="Symbol">∀{</a><a id="10478" href="../Confluence/#10478" class="Bound">Γ</a> <a id="10480" href="../Confluence/#10480" class="Bound">Δ</a><a id="10481" class="Symbol">}{</a><a id="10483" href="../Confluence/#10483" class="Bound">N</a> <a id="10485" class="Symbol">:</a> <a id="10487" href="../Confluence/#10478" class="Bound">Γ</a> <a id="10489" href="../Untyped/#3173" class="InductiveConstructor Operator">,</a> <a id="10491" href="../Untyped/#2870" class="InductiveConstructor">★</a> <a id="10493" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="10495" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="10496" class="Symbol">}{</a><a id="10498" href="../Confluence/#10498" class="Bound">M</a> <a id="10500" class="Symbol">:</a> <a id="10502" href="../Confluence/#10478" class="Bound">Γ</a> <a id="10504" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="10506" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="10507" class="Symbol">}{</a><a id="10509" href="../Confluence/#10509" class="Bound">ρ</a> <a id="10511" class="Symbol">:</a> <a id="10513" href="../Substitution/#2192" class="Function">Rename</a> <a id="10520" href="../Confluence/#10478" class="Bound">Γ</a> <a id="10522" href="../Confluence/#10480" class="Bound">Δ</a> <a id="10524" class="Symbol">}</a>
    <a id="10530" class="Symbol">→</a> <a id="10532" class="Symbol">(</a><a id="10533" href="../Untyped/#6217" class="Function">rename</a> <a id="10540" class="Symbol">(</a><a id="10541" href="../Untyped/#5907" class="Function">ext</a> <a id="10545" href="../Confluence/#10509" class="Bound">ρ</a><a id="10546" class="Symbol">)</a> <a id="10548" href="../Confluence/#10483" class="Bound">N</a><a id="10549" class="Symbol">)</a> <a id="10551" href="../Untyped/#7473" class="Function Operator">[</a> <a id="10553" href="../Untyped/#6217" class="Function">rename</a> <a id="10560" href="../Confluence/#10509" class="Bound">ρ</a> <a id="10562" href="../Confluence/#10498" class="Bound">M</a> <a id="10564" href="../Untyped/#7473" class="Function Operator">]</a> <a id="10566" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10568" href="../Untyped/#6217" class="Function">rename</a> <a id="10575" href="../Confluence/#10509" class="Bound">ρ</a> <a id="10577" class="Symbol">(</a><a id="10578" href="../Confluence/#10483" class="Bound">N</a> <a id="10580" href="../Untyped/#7473" class="Function Operator">[</a> <a id="10582" href="../Confluence/#10498" class="Bound">M</a> <a id="10584" href="../Untyped/#7473" class="Function Operator">]</a><a id="10585" class="Symbol">)</a>
<a id="10587" href="../Confluence/#10453" class="Function">rename-subst-commute</a> <a id="10608" class="Symbol">{</a><a id="10609" class="Argument">N</a> <a id="10611" class="Symbol">=</a> <a id="10613" href="../Confluence/#10613" class="Bound">N</a><a id="10614" class="Symbol">}</a> <a id="10616" class="Symbol">=</a> <a id="10618" href="../Substitution/#27914" class="Function">plfa.part2.Substitution.rename-subst-commute</a> <a id="10663" class="Symbol">{</a><a id="10664" class="Argument">N</a> <a id="10666" class="Symbol">=</a> <a id="10668" href="../Confluence/#10613" class="Bound">N</a><a id="10669" class="Symbol">}</a>
</pre>
<!--
Now for the `par-rename` lemma.
-->
<p>现在证明 <code>par-rename</code> 引理。</p>
<pre class="Agda"><a id="par-rename"></a><a id="10745" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10756" class="Symbol">:</a> <a id="10758" class="Symbol">∀{</a><a id="10760" href="../Confluence/#10760" class="Bound">Γ</a> <a id="10762" href="../Confluence/#10762" class="Bound">Δ</a> <a id="10764" href="../Confluence/#10764" class="Bound">A</a><a id="10765" class="Symbol">}</a> <a id="10767" class="Symbol">{</a><a id="10768" href="../Confluence/#10768" class="Bound">ρ</a> <a id="10770" class="Symbol">:</a> <a id="10772" href="../Substitution/#2192" class="Function">Rename</a> <a id="10779" href="../Confluence/#10760" class="Bound">Γ</a> <a id="10781" href="../Confluence/#10762" class="Bound">Δ</a><a id="10782" class="Symbol">}</a> <a id="10784" class="Symbol">{</a><a id="10785" href="../Confluence/#10785" class="Bound">M</a> <a id="10787" href="../Confluence/#10787" class="Bound">M′</a> <a id="10790" class="Symbol">:</a> <a id="10792" href="../Confluence/#10760" class="Bound">Γ</a> <a id="10794" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="10796" href="../Confluence/#10764" class="Bound">A</a><a id="10797" class="Symbol">}</a>
  <a id="10801" class="Symbol">→</a> <a id="10803" href="../Confluence/#10785" class="Bound">M</a> <a id="10805" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="10807" href="../Confluence/#10787" class="Bound">M′</a>
    <a id="10814" class="Comment">------------------------</a>
  <a id="10841" class="Symbol">→</a> <a id="10843" href="../Untyped/#6217" class="Function">rename</a> <a id="10850" href="../Confluence/#10768" class="Bound">ρ</a> <a id="10852" href="../Confluence/#10785" class="Bound">M</a> <a id="10854" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="10856" href="../Untyped/#6217" class="Function">rename</a> <a id="10863" href="../Confluence/#10768" class="Bound">ρ</a> <a id="10865" href="../Confluence/#10787" class="Bound">M′</a>
<a id="10868" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10879" href="../Confluence/#3490" class="InductiveConstructor">pvar</a> <a id="10884" class="Symbol">=</a> <a id="10886" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>
<a id="10891" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10902" class="Symbol">(</a><a id="10903" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="10908" href="../Confluence/#10908" class="Bound">p</a><a id="10909" class="Symbol">)</a> <a id="10911" class="Symbol">=</a> <a id="10913" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="10918" class="Symbol">(</a><a id="10919" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10930" href="../Confluence/#10908" class="Bound">p</a><a id="10931" class="Symbol">)</a>
<a id="10933" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10944" class="Symbol">(</a><a id="10945" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="10950" href="../Confluence/#10950" class="Bound">p₁</a> <a id="10953" href="../Confluence/#10953" class="Bound">p₂</a><a id="10955" class="Symbol">)</a> <a id="10957" class="Symbol">=</a> <a id="10959" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="10964" class="Symbol">(</a><a id="10965" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10976" href="../Confluence/#10950" class="Bound">p₁</a><a id="10978" class="Symbol">)</a> <a id="10980" class="Symbol">(</a><a id="10981" href="../Confluence/#10745" class="Function">par-rename</a> <a id="10992" href="../Confluence/#10953" class="Bound">p₂</a><a id="10994" class="Symbol">)</a>
<a id="10996" href="../Confluence/#10745" class="Function">par-rename</a> <a id="11007" class="Symbol">{</a><a id="11008" href="../Confluence/#11008" class="Bound">Γ</a><a id="11009" class="Symbol">}{</a><a id="11011" href="../Confluence/#11011" class="Bound">Δ</a><a id="11012" class="Symbol">}{</a><a id="11014" href="../Confluence/#11014" class="Bound">A</a><a id="11015" class="Symbol">}{</a><a id="11017" href="../Confluence/#11017" class="Bound">ρ</a><a id="11018" class="Symbol">}</a> <a id="11020" class="Symbol">(</a><a id="11021" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a><a id="11026" class="Symbol">{</a><a id="11027" href="../Confluence/#11008" class="Bound">Γ</a><a id="11028" class="Symbol">}{</a><a id="11030" href="../Confluence/#11030" class="Bound">N</a><a id="11031" class="Symbol">}{</a><a id="11033" href="../Confluence/#11033" class="Bound">N′</a><a id="11035" class="Symbol">}{</a><a id="11037" href="../Confluence/#11037" class="Bound">M</a><a id="11038" class="Symbol">}{</a><a id="11040" href="../Confluence/#11040" class="Bound">M′</a><a id="11042" class="Symbol">}</a> <a id="11044" href="../Confluence/#11044" class="Bound">p₁</a> <a id="11047" href="../Confluence/#11047" class="Bound">p₂</a><a id="11049" class="Symbol">)</a>
    <a id="11055" class="Keyword">with</a> <a id="11060" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="11066" class="Symbol">(</a><a id="11067" href="../Confluence/#10745" class="Function">par-rename</a><a id="11077" class="Symbol">{</a><a id="11078" class="Argument">ρ</a> <a id="11080" class="Symbol">=</a> <a id="11082" href="../Untyped/#5907" class="Function">ext</a> <a id="11086" href="../Confluence/#11017" class="Bound">ρ</a><a id="11087" class="Symbol">}</a> <a id="11089" href="../Confluence/#11044" class="Bound">p₁</a><a id="11091" class="Symbol">)</a> <a id="11093" class="Symbol">(</a><a id="11094" href="../Confluence/#10745" class="Function">par-rename</a><a id="11104" class="Symbol">{</a><a id="11105" class="Argument">ρ</a> <a id="11107" class="Symbol">=</a> <a id="11109" href="../Confluence/#11017" class="Bound">ρ</a><a id="11110" class="Symbol">}</a> <a id="11112" href="../Confluence/#11047" class="Bound">p₂</a><a id="11114" class="Symbol">)</a>
<a id="11116" class="Symbol">...</a> <a id="11120" class="Symbol">|</a> <a id="11122" href="../Confluence/#11122" class="Bound">G</a> <a id="11124" class="Keyword">rewrite</a> <a id="11132" href="../Confluence/#10453" class="Function">rename-subst-commute</a><a id="11152" class="Symbol">{</a><a id="11153" class="Bound">Γ</a><a id="11154" class="Symbol">}{</a><a id="11156" class="Bound">Δ</a><a id="11157" class="Symbol">}{</a><a id="11159" class="Bound">N′</a><a id="11161" class="Symbol">}{</a><a id="11163" class="Bound">M′</a><a id="11165" class="Symbol">}{</a><a id="11167" class="Bound">ρ</a><a id="11168" class="Symbol">}</a> <a id="11170" class="Symbol">=</a> <a id="11172" href="../Confluence/#11122" class="Bound">G</a>

</pre>
<!--
The proof is by induction on `M ⇛ M′`. The first three cases
are straightforward so we just consider the last one for `pbeta`.
-->
<p>证明通过对 <code>M ⇛ M′</code> 进行归纳来完成。前三种情况很简单， 所以我们只考虑最后一种，即 <code>pbeta</code>。</p>
<!--
* Suppose `(ƛ N) · M  ⇛  N′ [ M′ ]` because `N ⇛ N′` and `M ⇛ M′`.
  By the induction hypothesis, we have
  `rename (ext ρ) N ⇛ rename (ext ρ) N′` and
  `rename ρ M ⇛ rename ρ M′`.
  So by `pbeta` we have
  `(ƛ rename (ext ρ) N) · (rename ρ M) ⇛ (rename (ext ρ) N) [ rename ρ M ]`.
  However, to conclude we instead need parallel reduction to
  `rename ρ (N [ M ])`. But thankfully, renaming and substitution
  commute with one another.
-->
<ul>
<li>假定 <code>(ƛ N) · M  ⇛  N′ [ M′ ]</code> 因为 <code>N ⇛ N′</code> 和 <code>M ⇛ M′</code>。 根据归纳假设，我们有 <code>rename (ext ρ) N ⇛ rename (ext ρ) N′</code> 和 <code>rename ρ M ⇛ rename ρ M′</code>。 所以根据 <code>pbeta</code> 我们有 <code>(ƛ rename (ext ρ) N) · (rename ρ M) ⇛ (rename (ext ρ) N) [ rename ρ M ]</code>。 然而，为了得出结论我们需要平行规约至 <code>rename ρ (N [ M ])</code>。 值得庆幸的是，重命名和规约可以相互交换。</li>
</ul>
<!--
With the `par-rename` lemma in hand, it is straightforward to show
that extending substitutions preserves the pointwise parallel
reduction relation.
-->
<p>有了 <code>par-rename</code> 引理，很容易证明扩展替换保留了逐点平行归约关系。</p>
<pre class="Agda"><a id="par-subst-exts"></a><a id="12325" href="../Confluence/#12325" class="Function">par-subst-exts</a> <a id="12340" class="Symbol">:</a> <a id="12342" class="Symbol">∀{</a><a id="12344" href="../Confluence/#12344" class="Bound">Γ</a> <a id="12346" href="../Confluence/#12346" class="Bound">Δ</a><a id="12347" class="Symbol">}</a> <a id="12349" class="Symbol">{</a><a id="12350" href="../Confluence/#12350" class="Bound">σ</a> <a id="12352" href="../Confluence/#12352" class="Bound">τ</a> <a id="12354" class="Symbol">:</a> <a id="12356" href="../Substitution/#2405" class="Function">Subst</a> <a id="12362" href="../Confluence/#12344" class="Bound">Γ</a> <a id="12364" href="../Confluence/#12346" class="Bound">Δ</a><a id="12365" class="Symbol">}</a>
  <a id="12369" class="Symbol">→</a> <a id="12371" href="../Confluence/#9763" class="Function">par-subst</a> <a id="12381" href="../Confluence/#12350" class="Bound">σ</a> <a id="12383" href="../Confluence/#12352" class="Bound">τ</a>
    <a id="12389" class="Comment">------------------------------------------</a>
  <a id="12434" class="Symbol">→</a> <a id="12436" class="Symbol">∀{</a><a id="12438" href="../Confluence/#12438" class="Bound">B</a><a id="12439" class="Symbol">}</a> <a id="12441" class="Symbol">→</a> <a id="12443" href="../Confluence/#9763" class="Function">par-subst</a> <a id="12453" class="Symbol">(</a><a id="12454" href="../Untyped/#6653" class="Function">exts</a> <a id="12459" href="../Confluence/#12350" class="Bound">σ</a> <a id="12461" class="Symbol">{</a><a id="12462" class="Argument">B</a> <a id="12464" class="Symbol">=</a> <a id="12466" href="../Confluence/#12438" class="Bound">B</a><a id="12467" class="Symbol">})</a> <a id="12470" class="Symbol">(</a><a id="12471" href="../Untyped/#6653" class="Function">exts</a> <a id="12476" href="../Confluence/#12352" class="Bound">τ</a><a id="12477" class="Symbol">)</a>
<a id="12479" href="../Confluence/#12325" class="Function">par-subst-exts</a> <a id="12494" href="../Confluence/#12494" class="Bound">s</a> <a id="12496" class="Symbol">{</a><a id="12497" class="Argument">x</a> <a id="12499" class="Symbol">=</a> <a id="12501" href="../Untyped/#3539" class="InductiveConstructor">Z</a><a id="12502" class="Symbol">}</a> <a id="12504" class="Symbol">=</a> <a id="12506" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>
<a id="12511" href="../Confluence/#12325" class="Function">par-subst-exts</a> <a id="12526" href="../Confluence/#12526" class="Bound">s</a> <a id="12528" class="Symbol">{</a><a id="12529" class="Argument">x</a> <a id="12531" class="Symbol">=</a> <a id="12533" href="../Untyped/#3584" class="InductiveConstructor Operator">S</a> <a id="12535" href="../Confluence/#12535" class="Bound">x</a><a id="12536" class="Symbol">}</a> <a id="12538" class="Symbol">=</a> <a id="12540" href="../Confluence/#10745" class="Function">par-rename</a> <a id="12551" href="../Confluence/#12526" class="Bound">s</a>
</pre>
<!--
The next lemma that we need for proving that substitution respects
parallel reduction is the following which states that
simultaneous substitution commutes with single substitution. We import this
lemma from Chapter [Substitution](/Substitution/)
and restate it below.
-->
<p>为了证明替换遵从平行规约关系，我们需要证明的下一个引理如下文所示， 它声称同时规约可以与单步规约相交换。 我们从 <a href="../Substitution/">Substitution</a> 章节导入这个引理， 并重申如下。</p>
<pre class="Agda"><a id="subst-commute"></a><a id="12947" href="../Confluence/#12947" class="Function">subst-commute</a> <a id="12961" class="Symbol">:</a> <a id="12963" class="Symbol">∀{</a><a id="12965" href="../Confluence/#12965" class="Bound">Γ</a> <a id="12967" href="../Confluence/#12967" class="Bound">Δ</a><a id="12968" class="Symbol">}{</a><a id="12970" href="../Confluence/#12970" class="Bound">N</a> <a id="12972" class="Symbol">:</a> <a id="12974" href="../Confluence/#12965" class="Bound">Γ</a> <a id="12976" href="../Untyped/#3173" class="InductiveConstructor Operator">,</a> <a id="12978" href="../Untyped/#2870" class="InductiveConstructor">★</a> <a id="12980" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="12982" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="12983" class="Symbol">}{</a><a id="12985" href="../Confluence/#12985" class="Bound">M</a> <a id="12987" class="Symbol">:</a> <a id="12989" href="../Confluence/#12965" class="Bound">Γ</a> <a id="12991" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="12993" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="12994" class="Symbol">}{</a><a id="12996" href="../Confluence/#12996" class="Bound">σ</a> <a id="12998" class="Symbol">:</a> <a id="13000" href="../Substitution/#2405" class="Function">Subst</a> <a id="13006" href="../Confluence/#12965" class="Bound">Γ</a> <a id="13008" href="../Confluence/#12967" class="Bound">Δ</a> <a id="13010" class="Symbol">}</a>
  <a id="13014" class="Symbol">→</a> <a id="13016" href="../Untyped/#6945" class="Function">subst</a> <a id="13022" class="Symbol">(</a><a id="13023" href="../Untyped/#6653" class="Function">exts</a> <a id="13028" href="../Confluence/#12996" class="Bound">σ</a><a id="13029" class="Symbol">)</a> <a id="13031" href="../Confluence/#12970" class="Bound">N</a> <a id="13033" href="../Untyped/#7473" class="Function Operator">[</a> <a id="13035" href="../Untyped/#6945" class="Function">subst</a> <a id="13041" href="../Confluence/#12996" class="Bound">σ</a> <a id="13043" href="../Confluence/#12985" class="Bound">M</a> <a id="13045" href="../Untyped/#7473" class="Function Operator">]</a> <a id="13047" href="https://agda.github.io/agda-stdlib/v1.3/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13049" href="../Untyped/#6945" class="Function">subst</a> <a id="13055" href="../Confluence/#12996" class="Bound">σ</a> <a id="13057" class="Symbol">(</a><a id="13058" href="../Confluence/#12970" class="Bound">N</a> <a id="13060" href="../Untyped/#7473" class="Function Operator">[</a> <a id="13062" href="../Confluence/#12985" class="Bound">M</a> <a id="13064" href="../Untyped/#7473" class="Function Operator">]</a><a id="13065" class="Symbol">)</a>
<a id="13067" href="../Confluence/#12947" class="Function">subst-commute</a> <a id="13081" class="Symbol">{</a><a id="13082" class="Argument">N</a> <a id="13084" class="Symbol">=</a> <a id="13086" href="../Confluence/#13086" class="Bound">N</a><a id="13087" class="Symbol">}</a> <a id="13089" class="Symbol">=</a> <a id="13091" href="../Substitution/#26373" class="Function">plfa.part2.Substitution.subst-commute</a> <a id="13129" class="Symbol">{</a><a id="13130" class="Argument">N</a> <a id="13132" class="Symbol">=</a> <a id="13134" href="../Confluence/#13086" class="Bound">N</a><a id="13135" class="Symbol">}</a>
</pre>
<!--
We are ready to prove that substitution respects parallel reduction.
-->
<p>我们准备好去证明替换遵从平行规约。</p>
<pre class="Agda"><a id="subst-par"></a><a id="13244" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13254" class="Symbol">:</a> <a id="13256" class="Symbol">∀{</a><a id="13258" href="../Confluence/#13258" class="Bound">Γ</a> <a id="13260" href="../Confluence/#13260" class="Bound">Δ</a> <a id="13262" href="../Confluence/#13262" class="Bound">A</a><a id="13263" class="Symbol">}</a> <a id="13265" class="Symbol">{</a><a id="13266" href="../Confluence/#13266" class="Bound">σ</a> <a id="13268" href="../Confluence/#13268" class="Bound">τ</a> <a id="13270" class="Symbol">:</a> <a id="13272" href="../Substitution/#2405" class="Function">Subst</a> <a id="13278" href="../Confluence/#13258" class="Bound">Γ</a> <a id="13280" href="../Confluence/#13260" class="Bound">Δ</a><a id="13281" class="Symbol">}</a> <a id="13283" class="Symbol">{</a><a id="13284" href="../Confluence/#13284" class="Bound">M</a> <a id="13286" href="../Confluence/#13286" class="Bound">M′</a> <a id="13289" class="Symbol">:</a> <a id="13291" href="../Confluence/#13258" class="Bound">Γ</a> <a id="13293" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="13295" href="../Confluence/#13262" class="Bound">A</a><a id="13296" class="Symbol">}</a>
  <a id="13300" class="Symbol">→</a> <a id="13302" href="../Confluence/#9763" class="Function">par-subst</a> <a id="13312" href="../Confluence/#13266" class="Bound">σ</a> <a id="13314" href="../Confluence/#13268" class="Bound">τ</a>  <a id="13317" class="Symbol">→</a>  <a id="13320" href="../Confluence/#13284" class="Bound">M</a> <a id="13322" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="13324" href="../Confluence/#13286" class="Bound">M′</a>
    <a id="13331" class="Comment">--------------------------</a>
  <a id="13360" class="Symbol">→</a> <a id="13362" href="../Untyped/#6945" class="Function">subst</a> <a id="13368" href="../Confluence/#13266" class="Bound">σ</a> <a id="13370" href="../Confluence/#13284" class="Bound">M</a> <a id="13372" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="13374" href="../Untyped/#6945" class="Function">subst</a> <a id="13380" href="../Confluence/#13268" class="Bound">τ</a> <a id="13382" href="../Confluence/#13286" class="Bound">M′</a>
<a id="13385" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13395" class="Symbol">{</a><a id="13396" href="../Confluence/#13396" class="Bound">Γ</a><a id="13397" class="Symbol">}</a> <a id="13399" class="Symbol">{</a><a id="13400" href="../Confluence/#13400" class="Bound">Δ</a><a id="13401" class="Symbol">}</a> <a id="13403" class="Symbol">{</a><a id="13404" href="../Confluence/#13404" class="Bound">A</a><a id="13405" class="Symbol">}</a> <a id="13407" class="Symbol">{</a><a id="13408" href="../Confluence/#13408" class="Bound">σ</a><a id="13409" class="Symbol">}</a> <a id="13411" class="Symbol">{</a><a id="13412" href="../Confluence/#13412" class="Bound">τ</a><a id="13413" class="Symbol">}</a> <a id="13415" class="Symbol">{</a><a id="13416" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="13418" href="../Confluence/#13418" class="Bound">x</a><a id="13419" class="Symbol">}</a> <a id="13421" href="../Confluence/#13421" class="Bound">s</a> <a id="13423" href="../Confluence/#3490" class="InductiveConstructor">pvar</a> <a id="13428" class="Symbol">=</a> <a id="13430" href="../Confluence/#13421" class="Bound">s</a>
<a id="13432" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13442" class="Symbol">{</a><a id="13443" href="../Confluence/#13443" class="Bound">Γ</a><a id="13444" class="Symbol">}</a> <a id="13446" class="Symbol">{</a><a id="13447" href="../Confluence/#13447" class="Bound">Δ</a><a id="13448" class="Symbol">}</a> <a id="13450" class="Symbol">{</a><a id="13451" href="../Confluence/#13451" class="Bound">A</a><a id="13452" class="Symbol">}</a> <a id="13454" class="Symbol">{</a><a id="13455" href="../Confluence/#13455" class="Bound">σ</a><a id="13456" class="Symbol">}</a> <a id="13458" class="Symbol">{</a><a id="13459" href="../Confluence/#13459" class="Bound">τ</a><a id="13460" class="Symbol">}</a> <a id="13462" class="Symbol">{</a><a id="13463" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="13465" href="../Confluence/#13465" class="Bound">N</a><a id="13466" class="Symbol">}</a> <a id="13468" href="../Confluence/#13468" class="Bound">s</a> <a id="13470" class="Symbol">(</a><a id="13471" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="13476" href="../Confluence/#13476" class="Bound">p</a><a id="13477" class="Symbol">)</a> <a id="13479" class="Symbol">=</a>
  <a id="13483" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="13488" class="Symbol">(</a><a id="13489" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13499" class="Symbol">{</a><a id="13500" class="Argument">σ</a> <a id="13502" class="Symbol">=</a> <a id="13504" href="../Untyped/#6653" class="Function">exts</a> <a id="13509" href="../Confluence/#13455" class="Bound">σ</a><a id="13510" class="Symbol">}</a> <a id="13512" class="Symbol">{</a><a id="13513" class="Argument">τ</a> <a id="13515" class="Symbol">=</a> <a id="13517" href="../Untyped/#6653" class="Function">exts</a> <a id="13522" href="../Confluence/#13459" class="Bound">τ</a><a id="13523" class="Symbol">}</a>
        <a id="13533" class="Symbol">(λ</a> <a id="13536" class="Symbol">{</a><a id="13537" href="../Confluence/#13537" class="Bound">A</a><a id="13538" class="Symbol">}{</a><a id="13540" href="../Confluence/#13540" class="Bound">x</a><a id="13541" class="Symbol">}</a> <a id="13543" class="Symbol">→</a> <a id="13545" href="../Confluence/#12325" class="Function">par-subst-exts</a> <a id="13560" href="../Confluence/#13468" class="Bound">s</a> <a id="13562" class="Symbol">{</a><a id="13563" class="Argument">x</a> <a id="13565" class="Symbol">=</a> <a id="13567" href="../Confluence/#13540" class="Bound">x</a><a id="13568" class="Symbol">})</a> <a id="13571" href="../Confluence/#13476" class="Bound">p</a><a id="13572" class="Symbol">)</a>
<a id="13574" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13584" class="Symbol">{</a><a id="13585" href="../Confluence/#13585" class="Bound">Γ</a><a id="13586" class="Symbol">}</a> <a id="13588" class="Symbol">{</a><a id="13589" href="../Confluence/#13589" class="Bound">Δ</a><a id="13590" class="Symbol">}</a> <a id="13592" class="Symbol">{</a><a id="13593" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="13594" class="Symbol">}</a> <a id="13596" class="Symbol">{</a><a id="13597" href="../Confluence/#13597" class="Bound">σ</a><a id="13598" class="Symbol">}</a> <a id="13600" class="Symbol">{</a><a id="13601" href="../Confluence/#13601" class="Bound">τ</a><a id="13602" class="Symbol">}</a> <a id="13604" class="Symbol">{</a><a id="13605" href="../Confluence/#13605" class="Bound">L</a> <a id="13607" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="13609" href="../Confluence/#13609" class="Bound">M</a><a id="13610" class="Symbol">}</a> <a id="13612" href="../Confluence/#13612" class="Bound">s</a> <a id="13614" class="Symbol">(</a><a id="13615" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="13620" href="../Confluence/#13620" class="Bound">p₁</a> <a id="13623" href="../Confluence/#13623" class="Bound">p₂</a><a id="13625" class="Symbol">)</a> <a id="13627" class="Symbol">=</a>
  <a id="13631" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="13636" class="Symbol">(</a><a id="13637" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13647" href="../Confluence/#13612" class="Bound">s</a> <a id="13649" href="../Confluence/#13620" class="Bound">p₁</a><a id="13651" class="Symbol">)</a> <a id="13653" class="Symbol">(</a><a id="13654" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13664" href="../Confluence/#13612" class="Bound">s</a> <a id="13666" href="../Confluence/#13623" class="Bound">p₂</a><a id="13668" class="Symbol">)</a>
<a id="13670" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13680" class="Symbol">{</a><a id="13681" href="../Confluence/#13681" class="Bound">Γ</a><a id="13682" class="Symbol">}</a> <a id="13684" class="Symbol">{</a><a id="13685" href="../Confluence/#13685" class="Bound">Δ</a><a id="13686" class="Symbol">}</a> <a id="13688" class="Symbol">{</a><a id="13689" href="../Untyped/#2870" class="InductiveConstructor">★</a><a id="13690" class="Symbol">}</a> <a id="13692" class="Symbol">{</a><a id="13693" href="../Confluence/#13693" class="Bound">σ</a><a id="13694" class="Symbol">}</a> <a id="13696" class="Symbol">{</a><a id="13697" href="../Confluence/#13697" class="Bound">τ</a><a id="13698" class="Symbol">}</a> <a id="13700" class="Symbol">{(</a><a id="13702" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="13704" href="../Confluence/#13704" class="Bound">N</a><a id="13705" class="Symbol">)</a> <a id="13707" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="13709" href="../Confluence/#13709" class="Bound">M</a><a id="13710" class="Symbol">}</a> <a id="13712" href="../Confluence/#13712" class="Bound">s</a> <a id="13714" class="Symbol">(</a><a id="13715" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a><a id="13720" class="Symbol">{</a><a id="13721" class="Argument">N′</a> <a id="13724" class="Symbol">=</a> <a id="13726" href="../Confluence/#13726" class="Bound">N′</a><a id="13728" class="Symbol">}{</a><a id="13730" class="Argument">M′</a> <a id="13733" class="Symbol">=</a> <a id="13735" href="../Confluence/#13735" class="Bound">M′</a><a id="13737" class="Symbol">}</a> <a id="13739" href="../Confluence/#13739" class="Bound">p₁</a> <a id="13742" href="../Confluence/#13742" class="Bound">p₂</a><a id="13744" class="Symbol">)</a>
    <a id="13750" class="Keyword">with</a> <a id="13755" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="13761" class="Symbol">(</a><a id="13762" href="../Confluence/#13244" class="Function">subst-par</a><a id="13771" class="Symbol">{</a><a id="13772" class="Argument">σ</a> <a id="13774" class="Symbol">=</a> <a id="13776" href="../Untyped/#6653" class="Function">exts</a> <a id="13781" href="../Confluence/#13693" class="Bound">σ</a><a id="13782" class="Symbol">}{</a><a id="13784" class="Argument">τ</a> <a id="13786" class="Symbol">=</a> <a id="13788" href="../Untyped/#6653" class="Function">exts</a> <a id="13793" href="../Confluence/#13697" class="Bound">τ</a><a id="13794" class="Symbol">}{</a><a id="13796" class="Argument">M</a> <a id="13798" class="Symbol">=</a> <a id="13800" href="../Confluence/#13704" class="Bound">N</a><a id="13801" class="Symbol">}</a>
                        <a id="13827" class="Symbol">(λ{</a><a id="13830" href="../Confluence/#13830" class="Bound">A</a><a id="13831" class="Symbol">}{</a><a id="13833" href="../Confluence/#13833" class="Bound">x</a><a id="13834" class="Symbol">}</a> <a id="13836" class="Symbol">→</a> <a id="13838" href="../Confluence/#12325" class="Function">par-subst-exts</a> <a id="13853" href="../Confluence/#13712" class="Bound">s</a> <a id="13855" class="Symbol">{</a><a id="13856" class="Argument">x</a> <a id="13858" class="Symbol">=</a> <a id="13860" href="../Confluence/#13833" class="Bound">x</a><a id="13861" class="Symbol">})</a> <a id="13864" href="../Confluence/#13739" class="Bound">p₁</a><a id="13866" class="Symbol">)</a>
               <a id="13883" class="Symbol">(</a><a id="13884" href="../Confluence/#13244" class="Function">subst-par</a> <a id="13894" class="Symbol">{</a><a id="13895" class="Argument">σ</a> <a id="13897" class="Symbol">=</a> <a id="13899" href="../Confluence/#13693" class="Bound">σ</a><a id="13900" class="Symbol">}</a> <a id="13902" href="../Confluence/#13712" class="Bound">s</a> <a id="13904" href="../Confluence/#13742" class="Bound">p₂</a><a id="13906" class="Symbol">)</a>
<a id="13908" class="Symbol">...</a> <a id="13912" class="Symbol">|</a> <a id="13914" href="../Confluence/#13914" class="Bound">G</a> <a id="13916" class="Keyword">rewrite</a> <a id="13924" href="../Confluence/#12947" class="Function">subst-commute</a><a id="13937" class="Symbol">{</a><a id="13938" class="Argument">N</a> <a id="13940" class="Symbol">=</a> <a id="13942" class="Bound">N′</a><a id="13944" class="Symbol">}{</a><a id="13946" class="Argument">M</a> <a id="13948" class="Symbol">=</a> <a id="13950" class="Bound">M′</a><a id="13952" class="Symbol">}{</a><a id="13954" class="Argument">σ</a> <a id="13956" class="Symbol">=</a> <a id="13958" class="Bound">τ</a><a id="13959" class="Symbol">}</a> <a id="13961" class="Symbol">=</a> <a id="13963" href="../Confluence/#13914" class="Bound">G</a>
</pre>
<!--
We proceed by induction on `M ⇛ M′`.
-->
<p>我们通过对 <code>M ⇛ M′</code> 归纳来证明。</p>
<!--
* Suppose `x ⇛ x`. We conclude that `σ x ⇛ τ x` using
  the premise `par-subst σ τ`.

* Suppose `ƛ N ⇛ ƛ N′` because `N ⇛ N′`.
  To use the induction hypothesis, we need `par-subst (exts σ) (exts τ)`,
  which we obtain by `par-subst-exts`.
  So we have `subst (exts σ) N ⇛ subst (exts τ) N′`
  and conclude by rule `pabs`.

* Suppose `L · M ⇛ L′ · M′` because `L ⇛ L′` and `M ⇛ M′`.
  By the induction hypothesis we have
  `subst σ L ⇛ subst τ L′` and `subst σ M ⇛ subst τ M′`, so
  we conclude by rule `papp`.

* Suppose `(ƛ N) · M  ⇛  N′ [ M′ ]` because `N ⇛ N′` and `M ⇛ M′`.
  Again we obtain `par-subst (exts σ) (exts τ)` by `par-subst-exts`.
  So by the induction hypothesis, we have
  `subst (exts σ) N ⇛ subst (exts τ) N′` and
  `subst σ M ⇛ subst τ M′`. Then by rule `pbeta`, we have parallel reduction
  to `subst (exts τ) N′ [ subst τ M′ ]`.
  Substitution commutes with itself in the following sense.
  For any σ, N, and M, we have

        (subst (exts σ) N) [ subst σ M ] ≡ subst σ (N [ M ])

  So we have parallel reduction to `subst τ (N′ [ M′ ])`.
-->
<ul>
<li><p>假定 <code>x ⇛ x</code>。我们使用前提 <code>par-subst σ τ</code> 来得出 <code>σ x ⇛ τ x</code>。</p></li>
<li><p>假定 <code>ƛ N ⇛ ƛ N′</code> 因为 <code>N ⇛ N′</code>。 为了使用归纳假设，我们需要 <code>par-subst (exts σ) (exts τ)</code>， 它通过 <code>par-subst-exts</code> 得出。 所以我们有 <code>subst (exts σ) N ⇛ subst (exts τ) N′</code> 并且通过规则 <code>pabs</code> 来完成证明。</p></li>
<li><p>假定 <code>L · M ⇛ L′ · M′</code> 因为 <code>L ⇛ L′</code> 和 <code>M ⇛ M′</code>。 根据归纳假设我们有 <code>subst σ L ⇛ subst τ L′</code> 和 <code>subst σ M ⇛ subst τ M′</code>， 所以我们通过规则 <code>papp</code> 来完成证明。</p></li>
<li><p>假定 <code>(ƛ N) · M  ⇛  N′ [ M′ ]</code> 因为 <code>N ⇛ N′</code> 和 <code>M ⇛ M′</code>。 同样我们根据 <code>par-subst-exts</code> 来得到 <code>par-subst (exts σ) (exts τ)</code>。 所以根据归纳假设，我们有 <code>subst (exts σ) N ⇛ subst (exts τ) N′</code> 和 <code>subst σ M ⇛ subst τ M′</code>。 接着根据 <code>pbeta</code> 规则，我们平行规约至 <code>subst (exts τ) N′ [ subst τ M′ ]</code>。 替换在以下意义中与自身交换： 对于任意 σ、 N 和 M， 我们有</p>
<pre><code>  (subst (exts σ) N) [ subst σ M ] ≡ subst σ (N [ M ])</code></pre>
<p>所以我们平行规约得到 <code>subst τ (N′ [ M′ ])</code>。</p></li>
</ul>
<!--
Of course, if `M ⇛ M′`, then `subst-zero M` pointwise parallel reduces
to `subst-zero M′`.
-->
<p>显然，若 <code>M ⇛ M′</code>，则 <code>subst-zero M</code> 逐点平行规约至 <code>subst-zero M′</code>。</p>
<pre class="Agda"><a id="par-subst-zero"></a><a id="16046" href="../Confluence/#16046" class="Function">par-subst-zero</a> <a id="16061" class="Symbol">:</a> <a id="16063" class="Symbol">∀{</a><a id="16065" href="../Confluence/#16065" class="Bound">Γ</a><a id="16066" class="Symbol">}{</a><a id="16068" href="../Confluence/#16068" class="Bound">A</a><a id="16069" class="Symbol">}{</a><a id="16071" href="../Confluence/#16071" class="Bound">M</a> <a id="16073" href="../Confluence/#16073" class="Bound">M′</a> <a id="16076" class="Symbol">:</a> <a id="16078" href="../Confluence/#16065" class="Bound">Γ</a> <a id="16080" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="16082" href="../Confluence/#16068" class="Bound">A</a><a id="16083" class="Symbol">}</a>
       <a id="16092" class="Symbol">→</a> <a id="16094" href="../Confluence/#16071" class="Bound">M</a> <a id="16096" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="16098" href="../Confluence/#16073" class="Bound">M′</a>
       <a id="16108" class="Symbol">→</a> <a id="16110" href="../Confluence/#9763" class="Function">par-subst</a> <a id="16120" class="Symbol">(</a><a id="16121" href="../Untyped/#7357" class="Function">subst-zero</a> <a id="16132" href="../Confluence/#16071" class="Bound">M</a><a id="16133" class="Symbol">)</a> <a id="16135" class="Symbol">(</a><a id="16136" href="../Untyped/#7357" class="Function">subst-zero</a> <a id="16147" href="../Confluence/#16073" class="Bound">M′</a><a id="16149" class="Symbol">)</a>
<a id="16151" href="../Confluence/#16046" class="Function">par-subst-zero</a> <a id="16166" class="Symbol">{</a><a id="16167" href="../Confluence/#16167" class="Bound">M</a><a id="16168" class="Symbol">}</a> <a id="16170" class="Symbol">{</a><a id="16171" href="../Confluence/#16171" class="Bound">M′</a><a id="16173" class="Symbol">}</a> <a id="16175" href="../Confluence/#16175" class="Bound">p</a> <a id="16177" class="Symbol">{</a><a id="16178" href="../Confluence/#16178" class="Bound">A</a><a id="16179" class="Symbol">}</a> <a id="16181" class="Symbol">{</a><a id="16182" href="../Untyped/#3539" class="InductiveConstructor">Z</a><a id="16183" class="Symbol">}</a> <a id="16185" class="Symbol">=</a> <a id="16187" href="../Confluence/#16175" class="Bound">p</a>
<a id="16189" href="../Confluence/#16046" class="Function">par-subst-zero</a> <a id="16204" class="Symbol">{</a><a id="16205" href="../Confluence/#16205" class="Bound">M</a><a id="16206" class="Symbol">}</a> <a id="16208" class="Symbol">{</a><a id="16209" href="../Confluence/#16209" class="Bound">M′</a><a id="16211" class="Symbol">}</a> <a id="16213" href="../Confluence/#16213" class="Bound">p</a> <a id="16215" class="Symbol">{</a><a id="16216" href="../Confluence/#16216" class="Bound">A</a><a id="16217" class="Symbol">}</a> <a id="16219" class="Symbol">{</a><a id="16220" href="../Untyped/#3584" class="InductiveConstructor Operator">S</a> <a id="16222" href="../Confluence/#16222" class="Bound">x</a><a id="16223" class="Symbol">}</a> <a id="16225" class="Symbol">=</a> <a id="16227" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>
</pre>
<!--
We conclude this section with the desired corollary, that substitution
respects parallel reduction.
-->
<p>我们以所期望的推论来结束本节，即替换遵从平行规约。</p>
<pre class="Agda"><a id="sub-par"></a><a id="16378" href="../Confluence/#16378" class="Function">sub-par</a> <a id="16386" class="Symbol">:</a> <a id="16388" class="Symbol">∀{</a><a id="16390" href="../Confluence/#16390" class="Bound">Γ</a> <a id="16392" href="../Confluence/#16392" class="Bound">A</a> <a id="16394" href="../Confluence/#16394" class="Bound">B</a><a id="16395" class="Symbol">}</a> <a id="16397" class="Symbol">{</a><a id="16398" href="../Confluence/#16398" class="Bound">N</a> <a id="16400" href="../Confluence/#16400" class="Bound">N′</a> <a id="16403" class="Symbol">:</a> <a id="16405" href="../Confluence/#16390" class="Bound">Γ</a> <a id="16407" href="../Untyped/#3173" class="InductiveConstructor Operator">,</a> <a id="16409" href="../Confluence/#16392" class="Bound">A</a> <a id="16411" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="16413" href="../Confluence/#16394" class="Bound">B</a><a id="16414" class="Symbol">}</a> <a id="16416" class="Symbol">{</a><a id="16417" href="../Confluence/#16417" class="Bound">M</a> <a id="16419" href="../Confluence/#16419" class="Bound">M′</a> <a id="16422" class="Symbol">:</a> <a id="16424" href="../Confluence/#16390" class="Bound">Γ</a> <a id="16426" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="16428" href="../Confluence/#16392" class="Bound">A</a><a id="16429" class="Symbol">}</a>
  <a id="16433" class="Symbol">→</a> <a id="16435" href="../Confluence/#16398" class="Bound">N</a> <a id="16437" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="16439" href="../Confluence/#16400" class="Bound">N′</a>
  <a id="16444" class="Symbol">→</a> <a id="16446" href="../Confluence/#16417" class="Bound">M</a> <a id="16448" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="16450" href="../Confluence/#16419" class="Bound">M′</a>
    <a id="16457" class="Comment">--------------------------</a>
  <a id="16486" class="Symbol">→</a> <a id="16488" href="../Confluence/#16398" class="Bound">N</a> <a id="16490" href="../Untyped/#7473" class="Function Operator">[</a> <a id="16492" href="../Confluence/#16417" class="Bound">M</a> <a id="16494" href="../Untyped/#7473" class="Function Operator">]</a> <a id="16496" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="16498" href="../Confluence/#16400" class="Bound">N′</a> <a id="16501" href="../Untyped/#7473" class="Function Operator">[</a> <a id="16503" href="../Confluence/#16419" class="Bound">M′</a> <a id="16506" href="../Untyped/#7473" class="Function Operator">]</a>
<a id="16508" href="../Confluence/#16378" class="Function">sub-par</a> <a id="16516" href="../Confluence/#16516" class="Bound">pn</a> <a id="16519" href="../Confluence/#16519" class="Bound">pm</a> <a id="16522" class="Symbol">=</a> <a id="16524" href="../Confluence/#13244" class="Function">subst-par</a> <a id="16534" class="Symbol">(</a><a id="16535" href="../Confluence/#16046" class="Function">par-subst-zero</a> <a id="16550" href="../Confluence/#16519" class="Bound">pm</a><a id="16552" class="Symbol">)</a> <a id="16554" href="../Confluence/#16516" class="Bound">pn</a>
</pre>
<!--
## Parallel reduction satisfies the diamond property
-->
<h2 id="平行规约满足菱形性质">平行规约满足菱形性质</h2>
<!--
The heart of the confluence proof is made of stone, or rather, of
diamond!  We show that parallel reduction satisfies the diamond
property: that if `M ⇛ N` and `M ⇛ N′`, then `N ⇛ L` and `N′ ⇛ L` for
some `L`.  The typical proof is an induction on `M ⇛ N` and `M ⇛ N′`
so that every possible pair gives rise to a witness `L` given by
performing enough beta reductions in parallel.
-->
<p>合流性证明的核心是石头制成的，更确切地说，是钻石！ 【译注：在英文中 diamond 一词既指钻石，又指菱形。】 我们将证明平行规约满足菱形性质，即若有 <code>M ⇛ N</code> 和 <code>M ⇛ N′</code>， 那么对某个 <code>L</code> 有 <code>N ⇛ L</code> 和 <code>N′ ⇛ L</code>。 典型的证明通过对 <code>M ⇛ N</code> 和 <code>M ⇛ N′</code> 归纳来完成， 因此每一个可能的对都会在执行足够多次平行 β-规约后产生一个证明 <code>L</code>。</p>
<!--
However, a simpler approach is to perform as many beta reductions in
parallel as possible on `M`, say `M ⁺`, and then show that `N` also
parallel reduces to `M ⁺`. This is the idea of Takahashi's _complete
development_. The desired property may be illustrated as
-->
<p>然而，一个更简单的方法是对 <code>M</code> 执行尽可能多次平行 β-规约， 称其为 <code>M ⁺</code>，然后证明 <code>N</code> 也可以平行规约至 <code>M ⁺</code>。 这就是 Takahashi 的 <em>complete development</em> 的想法。 所需的性质可以表示为：</p>
<pre><code>    M
   /|
  / |
 /  |
N   2
 \  |
  \ |
   \|
    M⁺</code></pre>
<!--
where downward lines are instances of `⇛`, so we call it the _triangle
property_.
-->
<p>其中向下的线是 <code>⇛</code> 的实例。因此我们称其为<strong>三角性质（Triangle Property）</strong>。</p>
<pre class="Agda"><a id="_⁺"></a><a id="17874" href="../Confluence/#17874" class="Function Operator">_⁺</a> <a id="17877" class="Symbol">:</a> <a id="17879" class="Symbol">∀</a> <a id="17881" class="Symbol">{</a><a id="17882" href="../Confluence/#17882" class="Bound">Γ</a> <a id="17884" href="../Confluence/#17884" class="Bound">A</a><a id="17885" class="Symbol">}</a>
  <a id="17889" class="Symbol">→</a> <a id="17891" href="../Confluence/#17882" class="Bound">Γ</a> <a id="17893" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="17895" href="../Confluence/#17884" class="Bound">A</a> <a id="17897" class="Symbol">→</a> <a id="17899" href="../Confluence/#17882" class="Bound">Γ</a> <a id="17901" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="17903" href="../Confluence/#17884" class="Bound">A</a>
<a id="17905" class="Symbol">(</a><a id="17906" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="17908" href="../Confluence/#17908" class="Bound">x</a><a id="17909" class="Symbol">)</a> <a id="17911" href="../Confluence/#17874" class="Function Operator">⁺</a>       <a id="17919" class="Symbol">=</a>  <a id="17922" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="17924" href="../Confluence/#17908" class="Bound">x</a>
<a id="17926" class="Symbol">(</a><a id="17927" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="17929" href="../Confluence/#17929" class="Bound">M</a><a id="17930" class="Symbol">)</a> <a id="17932" href="../Confluence/#17874" class="Function Operator">⁺</a>       <a id="17940" class="Symbol">=</a> <a id="17942" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="17944" class="Symbol">(</a><a id="17945" href="../Confluence/#17929" class="Bound">M</a> <a id="17947" href="../Confluence/#17874" class="Function Operator">⁺</a><a id="17948" class="Symbol">)</a>
<a id="17950" class="Symbol">((</a><a id="17952" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="17954" href="../Confluence/#17954" class="Bound">N</a><a id="17955" class="Symbol">)</a> <a id="17957" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="17959" href="../Confluence/#17959" class="Bound">M</a><a id="17960" class="Symbol">)</a> <a id="17962" href="../Confluence/#17874" class="Function Operator">⁺</a> <a id="17964" class="Symbol">=</a> <a id="17966" href="../Confluence/#17954" class="Bound">N</a> <a id="17968" href="../Confluence/#17874" class="Function Operator">⁺</a> <a id="17970" href="../Untyped/#7473" class="Function Operator">[</a> <a id="17972" href="../Confluence/#17959" class="Bound">M</a> <a id="17974" href="../Confluence/#17874" class="Function Operator">⁺</a> <a id="17976" href="../Untyped/#7473" class="Function Operator">]</a>
<a id="17978" class="CatchallClause Symbol">(</a><a id="17979" href="../Confluence/#17979" class="CatchallClause Bound">L</a><a id="17980" class="CatchallClause"> </a><a id="17981" href="../Untyped/#4424" class="CatchallClause InductiveConstructor Operator">·</a><a id="17982" class="CatchallClause"> </a><a id="17983" href="../Confluence/#17983" class="CatchallClause Bound">M</a><a id="17984" class="CatchallClause Symbol">)</a><a id="17985" class="CatchallClause"> </a><a id="17986" href="../Confluence/#17874" class="CatchallClause Function Operator">⁺</a>     <a id="17992" class="Symbol">=</a> <a id="17994" href="../Confluence/#17979" class="Bound">L</a> <a id="17996" href="../Confluence/#17874" class="Function Operator">⁺</a> <a id="17998" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="18000" class="Symbol">(</a><a id="18001" href="../Confluence/#17983" class="Bound">M</a> <a id="18003" href="../Confluence/#17874" class="Function Operator">⁺</a><a id="18004" class="Symbol">)</a>

<a id="par-triangle"></a><a id="18007" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18020" class="Symbol">:</a> <a id="18022" class="Symbol">∀</a> <a id="18024" class="Symbol">{</a><a id="18025" href="../Confluence/#18025" class="Bound">Γ</a> <a id="18027" href="../Confluence/#18027" class="Bound">A</a><a id="18028" class="Symbol">}</a> <a id="18030" class="Symbol">{</a><a id="18031" href="../Confluence/#18031" class="Bound">M</a> <a id="18033" href="../Confluence/#18033" class="Bound">N</a> <a id="18035" class="Symbol">:</a> <a id="18037" href="../Confluence/#18025" class="Bound">Γ</a> <a id="18039" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="18041" href="../Confluence/#18027" class="Bound">A</a><a id="18042" class="Symbol">}</a>
  <a id="18046" class="Symbol">→</a> <a id="18048" href="../Confluence/#18031" class="Bound">M</a> <a id="18050" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="18052" href="../Confluence/#18033" class="Bound">N</a>
    <a id="18058" class="Comment">-------</a>
  <a id="18068" class="Symbol">→</a> <a id="18070" href="../Confluence/#18033" class="Bound">N</a> <a id="18072" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="18074" href="../Confluence/#18031" class="Bound">M</a> <a id="18076" href="../Confluence/#17874" class="Function Operator">⁺</a>
<a id="18078" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18091" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>          <a id="18105" class="Symbol">=</a> <a id="18107" href="../Confluence/#3490" class="InductiveConstructor">pvar</a>
<a id="18112" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18125" class="Symbol">(</a><a id="18126" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="18131" href="../Confluence/#18131" class="Bound">p</a><a id="18132" class="Symbol">)</a>      <a id="18139" class="Symbol">=</a> <a id="18141" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="18146" class="Symbol">(</a><a id="18147" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18160" href="../Confluence/#18131" class="Bound">p</a><a id="18161" class="Symbol">)</a>
<a id="18163" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18176" class="Symbol">(</a><a id="18177" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="18183" href="../Confluence/#18183" class="Bound">p1</a> <a id="18186" href="../Confluence/#18186" class="Bound">p2</a><a id="18188" class="Symbol">)</a> <a id="18190" class="Symbol">=</a> <a id="18192" href="../Confluence/#16378" class="Function">sub-par</a> <a id="18200" class="Symbol">(</a><a id="18201" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18214" href="../Confluence/#18183" class="Bound">p1</a><a id="18216" class="Symbol">)</a> <a id="18218" class="Symbol">(</a><a id="18219" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18232" href="../Confluence/#18186" class="Bound">p2</a><a id="18234" class="Symbol">)</a>
<a id="18236" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18249" class="Symbol">(</a><a id="18250" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="18255" class="Symbol">{</a><a id="18256" class="Argument">L</a> <a id="18258" class="Symbol">=</a> <a id="18260" href="../Untyped/#4364" class="InductiveConstructor Operator">ƛ</a> <a id="18262" class="Symbol">_</a> <a id="18264" class="Symbol">}</a> <a id="18266" class="Symbol">(</a><a id="18267" href="../Confluence/#3554" class="InductiveConstructor">pabs</a> <a id="18272" href="../Confluence/#18272" class="Bound">p1</a><a id="18274" class="Symbol">)</a> <a id="18276" href="../Confluence/#18276" class="Bound">p2</a><a id="18278" class="Symbol">)</a> <a id="18280" class="Symbol">=</a>
  <a id="18284" href="../Confluence/#3740" class="InductiveConstructor">pbeta</a> <a id="18290" class="Symbol">(</a><a id="18291" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18304" href="../Confluence/#18272" class="Bound">p1</a><a id="18306" class="Symbol">)</a> <a id="18308" class="Symbol">(</a><a id="18309" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18322" href="../Confluence/#18276" class="Bound">p2</a><a id="18324" class="Symbol">)</a>
<a id="18326" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18339" class="Symbol">(</a><a id="18340" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="18345" class="Symbol">{</a><a id="18346" class="Argument">L</a> <a id="18348" class="Symbol">=</a> <a id="18350" href="../Untyped/#4312" class="InductiveConstructor Operator">`</a> <a id="18352" class="Symbol">_}</a>   <a id="18357" href="../Confluence/#18357" class="Bound">p1</a> <a id="18360" href="../Confluence/#18360" class="Bound">p2</a><a id="18362" class="Symbol">)</a> <a id="18364" class="Symbol">=</a> <a id="18366" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="18371" class="Symbol">(</a><a id="18372" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18385" href="../Confluence/#18357" class="Bound">p1</a><a id="18387" class="Symbol">)</a> <a id="18389" class="Symbol">(</a><a id="18390" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18403" href="../Confluence/#18360" class="Bound">p2</a><a id="18405" class="Symbol">)</a>
<a id="18407" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18420" class="Symbol">(</a><a id="18421" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="18426" class="Symbol">{</a><a id="18427" class="Argument">L</a> <a id="18429" class="Symbol">=</a> <a id="18431" class="Symbol">_</a> <a id="18433" href="../Untyped/#4424" class="InductiveConstructor Operator">·</a> <a id="18435" class="Symbol">_}</a> <a id="18438" href="../Confluence/#18438" class="Bound">p1</a> <a id="18441" href="../Confluence/#18441" class="Bound">p2</a><a id="18443" class="Symbol">)</a> <a id="18445" class="Symbol">=</a> <a id="18447" href="../Confluence/#3634" class="InductiveConstructor">papp</a> <a id="18452" class="Symbol">(</a><a id="18453" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18466" href="../Confluence/#18438" class="Bound">p1</a><a id="18468" class="Symbol">)</a> <a id="18470" class="Symbol">(</a><a id="18471" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="18484" href="../Confluence/#18441" class="Bound">p2</a><a id="18486" class="Symbol">)</a>
</pre>
<!--
The proof of the triangle property is an induction on `M ⇛ N`.
-->
<p>三角性质的证明通过对 <code>M ⇛ N</code> 归纳来完成。</p>
<!--
* Suppose `x ⇛ x`. Clearly `x ⁺ = x`, so `x ⇛ x ⁺`.

* Suppose `ƛ M ⇛ ƛ N`. By the induction hypothesis we have `N ⇛ M ⁺`
  and by definition `(λ M) ⁺ = λ (M ⁺)`, so we conclude that `λ N ⇛ λ
  (M ⁺)`.

* Suppose `(λ N) · M ⇛ N′ [ M′ ]`. By the induction hypothesis, we have
  `N′ ⇛ N ⁺` and `M′ ⇛ M ⁺`. Since substitution respects parallel reduction,
  it follows that `N′ [ M′ ] ⇛ N ⁺ [ M ⁺ ]`, but the right hand side
  is exactly `((λ N) · M) ⁺`, hence `N′ [ M′ ] ⇛ ((λ N) · M) ⁺`.

* Suppose `(λ L) · M ⇛ (λ L′) · M′`. By the induction hypothesis
  we have `L′ ⇛ L ⁺` and `M′ ⇛ M ⁺`; by definition `((λ L) · M) ⁺ = L ⁺ [ M ⁺ ]`.
  It follows `(λ L′) · M′ ⇛ L ⁺ [ M ⁺ ]`.

* Suppose `x · M ⇛ x · M′`. By the induction hypothesis we have `M′ ⇛ M ⁺`
  and `x ⇛ x ⁺` so that `x · M′ ⇛ x · M ⁺`.
  The remaining case is proved in the same way, so we ignore it.  (As
  there is currently no way in Agda to expand the catch-all pattern in
  the definition of `_⁺` for us before checking the right-hand side,
  we have to write down the remaining case explicitly.)
-->
<ul>
<li><p>假定 <code>x ⇛ x</code>。显然 <code>x ⁺ = x</code>，所以 <code>x ⇛ x ⁺</code>。</p></li>
<li><p>假定 <code>ƛ M ⇛ ƛ N</code>。根据归纳假设我们有 <code>N ⇛ M ⁺</code>， 并且根据定义我们有 <code>(λ M) ⁺ = λ (M ⁺)</code>，所以我们得出 <code>λ N ⇛ λ(M ⁺)</code>。</p></li>
<li><p>假定 <code>(λ N) · M ⇛ N′ [ M′ ]</code>。根据归纳假设我们有 <code>N′ ⇛ N ⁺</code> 和 <code>M′ ⇛ M ⁺</code>。 因为替换遵从平行规约，于是得到 <code>N′ [ M′ ] ⇛ N ⁺ [ M ⁺ ]</code>， 而右侧即为 <code>((λ N) · M) ⁺</code>，因此有 <code>N′ [ M′ ] ⇛ ((λ N) · M) ⁺</code>。</p></li>
<li><p>假定 <code>(λ L) · M ⇛ (λ L′) · M′</code>。 根据归纳假设我们有 <code>L′ ⇛ L ⁺</code> 和 <code>M′ ⇛ M ⁺</code>； 根据定义有 <code>((λ L) · M) ⁺ = L ⁺ [ M ⁺ ]</code>。 接着得出 <code>(λ L′) · M′ ⇛ L ⁺ [ M ⁺ ]</code>。</p></li>
<li><p>假定 <code>x · M ⇛ x · M′</code>。 根据归纳假设我们有 <code>M′ ⇛ M ⁺</code> 和 <code>x ⇛ x ⁺</code>，因此 <code>x · M′ ⇛ x · M ⁺</code>。 剩余的情况可以以相同方式证明，所以我们忽略它。 （由于 Agda 目前没有办法在检查右侧之前为我们扩展 <code>_⁺</code> 定义中的 catch-all 模式，我们必须明确地写下剩余的情况。）</p></li>
</ul>
<!--
The diamond property then follows by halving the diamond into two triangles.
-->
<p>菱形性质接着通过将菱形折半成两个三角形得出。</p>
<pre><code>    M
   /|\
  / | \
 /  |  \
N   2   N′
 \  |  /
  \ | /
   \|/
    M⁺</code></pre>
<!--
That is, the diamond property is proved by applying the
triangle property on each side with the same confluent term `M ⁺`.
-->
<p>也就是说，菱形性质通过在两侧应用具有相同合流项 <code>M ⁺</code>的三角性质而证明。</p>
<pre class="Agda"><a id="par-diamond"></a><a id="20697" href="../Confluence/#20697" class="Function">par-diamond</a> <a id="20709" class="Symbol">:</a> <a id="20711" class="Symbol">∀{</a><a id="20713" href="../Confluence/#20713" class="Bound">Γ</a> <a id="20715" href="../Confluence/#20715" class="Bound">A</a><a id="20716" class="Symbol">}</a> <a id="20718" class="Symbol">{</a><a id="20719" href="../Confluence/#20719" class="Bound">M</a> <a id="20721" href="../Confluence/#20721" class="Bound">N</a> <a id="20723" href="../Confluence/#20723" class="Bound">N′</a> <a id="20726" class="Symbol">:</a> <a id="20728" href="../Confluence/#20713" class="Bound">Γ</a> <a id="20730" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="20732" href="../Confluence/#20715" class="Bound">A</a><a id="20733" class="Symbol">}</a>
  <a id="20737" class="Symbol">→</a> <a id="20739" href="../Confluence/#20719" class="Bound">M</a> <a id="20741" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="20743" href="../Confluence/#20721" class="Bound">N</a>
  <a id="20747" class="Symbol">→</a> <a id="20749" href="../Confluence/#20719" class="Bound">M</a> <a id="20751" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="20753" href="../Confluence/#20723" class="Bound">N′</a>
    <a id="20760" class="Comment">---------------------------------</a>
  <a id="20796" class="Symbol">→</a> <a id="20798" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Σ[</a> <a id="20801" href="../Confluence/#20801" class="Bound">L</a> <a id="20803" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">∈</a> <a id="20805" href="../Confluence/#20713" class="Bound">Γ</a> <a id="20807" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="20809" href="../Confluence/#20715" class="Bound">A</a> <a id="20811" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="20813" class="Symbol">(</a><a id="20814" href="../Confluence/#20721" class="Bound">N</a> <a id="20816" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="20818" href="../Confluence/#20801" class="Bound">L</a><a id="20819" class="Symbol">)</a> <a id="20821" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">×</a> <a id="20823" class="Symbol">(</a><a id="20824" href="../Confluence/#20723" class="Bound">N′</a> <a id="20827" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="20829" href="../Confluence/#20801" class="Bound">L</a><a id="20830" class="Symbol">)</a>
<a id="20832" href="../Confluence/#20697" class="Function">par-diamond</a> <a id="20844" class="Symbol">{</a><a id="20845" class="Argument">M</a> <a id="20847" class="Symbol">=</a> <a id="20849" href="../Confluence/#20849" class="Bound">M</a><a id="20850" class="Symbol">}</a> <a id="20852" href="../Confluence/#20852" class="Bound">p1</a> <a id="20855" href="../Confluence/#20855" class="Bound">p2</a> <a id="20858" class="Symbol">=</a> <a id="20860" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="20862" href="../Confluence/#20849" class="Bound">M</a> <a id="20864" href="../Confluence/#17874" class="Function Operator">⁺</a> <a id="20866" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="20868" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="20870" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="20883" href="../Confluence/#20852" class="Bound">p1</a> <a id="20886" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="20888" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="20901" href="../Confluence/#20855" class="Bound">p2</a> <a id="20904" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="20906" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
</pre>
<!--
This step is optional, though, in the presence of triangle property.
-->
<p>不过，在存在三角性质的情况下，该步骤是可选的。</p>
<!--
#### Exercise (practice)
-->
<h4 id="练习实践">练习（实践）</h4>
<!--
* Prove the diamond property `par-diamond` directly by induction on `M ⇛ N` and `M ⇛ N′`.

* Draw pictures that represent the proofs of each of the six cases in
  the direct proof of `par-diamond`. The pictures should consist of nodes
  and directed edges, where each node is labeled with a term and each
  edge represents parallel reduction.
-->
<ul>
<li><p>通过对 <code>M ⇛ N</code> 和 <code>M ⇛ N′</code> 归纳直接证明菱形性质 <code>par-diamond</code>。</p></li>
<li><p>作图表示 <code>par-diamond</code> 的直接证明中的六种情况。 图应当包含节点和有向边，其中节点用项标记，边代表平行规约。</p></li>
</ul>
<!--
## Proof of confluence for parallel reduction
-->
<h2 id="平行规约合流性的证明">平行规约合流性的证明</h2>
<!--
As promised at the beginning, the proof that parallel reduction is
confluent is easy now that we know it satisfies the triangle property.
We just need to prove the strip lemma, which states that
if `M ⇛ N` and `M ⇛* N′`, then
`N ⇛* L` and `N′ ⇛ L` for some `L`.
The following diagram illustrates the strip lemma
-->
<p>像在开始承诺的那样，平行规约合流性的证明现在十分简单， 因为我们知道它满足三角性质。 我们只需证明带状引理（Strip Lemma），它声称若有 <code>M ⇛ N</code> 和 <code>M ⇛* N′</code>， 则对于某个 <code>L</code> 有 <code>N ⇛* L</code> 和 <code>N′ ⇛ L</code>。 下图解释了带状引理：</p>
<pre><code>    M
   / \
  1   *
 /     \
N       N′
 \     /
  *   1
   \ /
    L</code></pre>
<!--
where downward lines are instances of `⇛` or `⇛*`, depending on how
they are marked.
-->
<p>此处向下的线是 <code>⇛</code> 或 <code>⇛*</code> 的实例，取决于它们如何被标记。</p>
<!--
The proof of the strip lemma is a straightforward induction on `M ⇛* N′`,
using the triangle property in the induction step.
-->
<p>带状引理的证明是对 <code>M ⇛* N′</code> 的简单归纳，并在归纳步骤使用三角性质。</p>
<pre class="Agda"><a id="strip"></a><a id="22488" href="../Confluence/#22488" class="Function">strip</a> <a id="22494" class="Symbol">:</a> <a id="22496" class="Symbol">∀{</a><a id="22498" href="../Confluence/#22498" class="Bound">Γ</a> <a id="22500" href="../Confluence/#22500" class="Bound">A</a><a id="22501" class="Symbol">}</a> <a id="22503" class="Symbol">{</a><a id="22504" href="../Confluence/#22504" class="Bound">M</a> <a id="22506" href="../Confluence/#22506" class="Bound">N</a> <a id="22508" href="../Confluence/#22508" class="Bound">N′</a> <a id="22511" class="Symbol">:</a> <a id="22513" href="../Confluence/#22498" class="Bound">Γ</a> <a id="22515" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="22517" href="../Confluence/#22500" class="Bound">A</a><a id="22518" class="Symbol">}</a>
  <a id="22522" class="Symbol">→</a> <a id="22524" href="../Confluence/#22504" class="Bound">M</a> <a id="22526" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="22528" href="../Confluence/#22506" class="Bound">N</a>
  <a id="22532" class="Symbol">→</a> <a id="22534" href="../Confluence/#22504" class="Bound">M</a> <a id="22536" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="22539" href="../Confluence/#22508" class="Bound">N′</a>
    <a id="22546" class="Comment">------------------------------------</a>
  <a id="22585" class="Symbol">→</a> <a id="22587" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Σ[</a> <a id="22590" href="../Confluence/#22590" class="Bound">L</a> <a id="22592" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">∈</a> <a id="22594" href="../Confluence/#22498" class="Bound">Γ</a> <a id="22596" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="22598" href="../Confluence/#22500" class="Bound">A</a> <a id="22600" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="22602" class="Symbol">(</a><a id="22603" href="../Confluence/#22506" class="Bound">N</a> <a id="22605" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="22608" href="../Confluence/#22590" class="Bound">L</a><a id="22609" class="Symbol">)</a>  <a id="22612" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">×</a>  <a id="22615" class="Symbol">(</a><a id="22616" href="../Confluence/#22508" class="Bound">N′</a> <a id="22619" href="../Confluence/#3441" class="Datatype Operator">⇛</a> <a id="22621" href="../Confluence/#22590" class="Bound">L</a><a id="22622" class="Symbol">)</a>
<a id="22624" href="../Confluence/#22488" class="Function">strip</a><a id="22629" class="Symbol">{</a><a id="22630" href="../Confluence/#22630" class="Bound">Γ</a><a id="22631" class="Symbol">}{</a><a id="22633" href="../Confluence/#22633" class="Bound">A</a><a id="22634" class="Symbol">}{</a><a id="22636" href="../Confluence/#22636" class="Bound">M</a><a id="22637" class="Symbol">}{</a><a id="22639" href="../Confluence/#22639" class="Bound">N</a><a id="22640" class="Symbol">}{</a><a id="22642" href="../Confluence/#22642" class="Bound">N′</a><a id="22644" class="Symbol">}</a> <a id="22646" href="../Confluence/#22646" class="Bound">mn</a> <a id="22649" class="Symbol">(</a><a id="22650" href="../Confluence/#22636" class="Bound">M</a> <a id="22652" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a><a id="22653" class="Symbol">)</a> <a id="22655" class="Symbol">=</a> <a id="22657" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22659" href="../Confluence/#22639" class="Bound">N</a> <a id="22661" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22663" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22665" href="../Confluence/#22639" class="Bound">N</a> <a id="22667" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a> <a id="22669" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22671" href="../Confluence/#22646" class="Bound">mn</a> <a id="22674" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="22676" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
<a id="22678" href="../Confluence/#22488" class="Function">strip</a><a id="22683" class="Symbol">{</a><a id="22684" href="../Confluence/#22684" class="Bound">Γ</a><a id="22685" class="Symbol">}{</a><a id="22687" href="../Confluence/#22687" class="Bound">A</a><a id="22688" class="Symbol">}{</a><a id="22690" href="../Confluence/#22690" class="Bound">M</a><a id="22691" class="Symbol">}{</a><a id="22693" href="../Confluence/#22693" class="Bound">N</a><a id="22694" class="Symbol">}{</a><a id="22696" href="../Confluence/#22696" class="Bound">N′</a><a id="22698" class="Symbol">}</a> <a id="22700" href="../Confluence/#22700" class="Bound">mn</a> <a id="22703" class="Symbol">(</a><a id="22704" href="../Confluence/#22690" class="Bound">M</a> <a id="22706" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="22709" href="../Confluence/#22709" class="Bound">mm'</a> <a id="22713" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="22715" href="../Confluence/#22715" class="Bound">m'n'</a><a id="22719" class="Symbol">)</a>
  <a id="22723" class="Keyword">with</a> <a id="22728" href="../Confluence/#22488" class="Function">strip</a> <a id="22734" class="Symbol">(</a><a id="22735" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="22748" href="../Confluence/#22709" class="Bound">mm'</a><a id="22751" class="Symbol">)</a> <a id="22753" href="../Confluence/#22715" class="Bound">m'n'</a>
<a id="22758" class="Symbol">...</a> <a id="22762" class="Symbol">|</a> <a id="22764" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22766" href="../Confluence/#22766" class="Bound">L</a> <a id="22768" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22770" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22772" href="../Confluence/#22772" class="Bound">ll'</a> <a id="22776" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22778" href="../Confluence/#22778" class="Bound">n'l'</a> <a id="22783" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="22785" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="22787" class="Symbol">=</a> <a id="22789" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22791" href="../Confluence/#22766" class="Bound">L</a> <a id="22793" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22795" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="22797" class="Bound">N</a> <a id="22799" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="22802" href="../Confluence/#18007" class="Function">par-triangle</a> <a id="22815" class="Bound">mn</a> <a id="22818" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="22820" href="../Confluence/#22772" class="Bound">ll'</a> <a id="22824" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="22826" href="../Confluence/#22778" class="Bound">n'l'</a> <a id="22831" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="22833" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
</pre>
<!--
The proof of confluence for parallel reduction is now proved by
induction on the sequence `M ⇛* N`, using the above lemma in the
induction step.
-->
<p>平行规约合流性的证明现在通过对序列 <code>M ⇛* N</code> 归纳来完成，并在归纳步骤使用上述引理。</p>
<pre class="Agda"><a id="par-confluence"></a><a id="23047" href="../Confluence/#23047" class="Function">par-confluence</a> <a id="23062" class="Symbol">:</a> <a id="23064" class="Symbol">∀{</a><a id="23066" href="../Confluence/#23066" class="Bound">Γ</a> <a id="23068" href="../Confluence/#23068" class="Bound">A</a><a id="23069" class="Symbol">}</a> <a id="23071" class="Symbol">{</a><a id="23072" href="../Confluence/#23072" class="Bound">L</a> <a id="23074" href="../Confluence/#23074" class="Bound">M₁</a> <a id="23077" href="../Confluence/#23077" class="Bound">M₂</a> <a id="23080" class="Symbol">:</a> <a id="23082" href="../Confluence/#23066" class="Bound">Γ</a> <a id="23084" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="23086" href="../Confluence/#23068" class="Bound">A</a><a id="23087" class="Symbol">}</a>
  <a id="23091" class="Symbol">→</a> <a id="23093" href="../Confluence/#23072" class="Bound">L</a> <a id="23095" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="23098" href="../Confluence/#23074" class="Bound">M₁</a>
  <a id="23103" class="Symbol">→</a> <a id="23105" href="../Confluence/#23072" class="Bound">L</a> <a id="23107" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="23110" href="../Confluence/#23077" class="Bound">M₂</a>
    <a id="23117" class="Comment">------------------------------------</a>
  <a id="23156" class="Symbol">→</a> <a id="23158" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Σ[</a> <a id="23161" href="../Confluence/#23161" class="Bound">N</a> <a id="23163" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">∈</a> <a id="23165" href="../Confluence/#23066" class="Bound">Γ</a> <a id="23167" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="23169" href="../Confluence/#23068" class="Bound">A</a> <a id="23171" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="23173" class="Symbol">(</a><a id="23174" href="../Confluence/#23074" class="Bound">M₁</a> <a id="23177" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="23180" href="../Confluence/#23161" class="Bound">N</a><a id="23181" class="Symbol">)</a> <a id="23183" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">×</a> <a id="23185" class="Symbol">(</a><a id="23186" href="../Confluence/#23077" class="Bound">M₂</a> <a id="23189" href="../Confluence/#4758" class="Datatype Operator">⇛*</a> <a id="23192" href="../Confluence/#23161" class="Bound">N</a><a id="23193" class="Symbol">)</a>
<a id="23195" href="../Confluence/#23047" class="Function">par-confluence</a> <a id="23210" class="Symbol">{</a><a id="23211" href="../Confluence/#23211" class="Bound">Γ</a><a id="23212" class="Symbol">}{</a><a id="23214" href="../Confluence/#23214" class="Bound">A</a><a id="23215" class="Symbol">}{</a><a id="23217" href="../Confluence/#23217" class="Bound">L</a><a id="23218" class="Symbol">}{</a><a id="23220" class="DottedPattern Symbol">.</a><a id="23221" href="../Confluence/#23217" class="DottedPattern Bound">L</a><a id="23222" class="Symbol">}{</a><a id="23224" href="../Confluence/#23224" class="Bound">N</a><a id="23225" class="Symbol">}</a> <a id="23227" class="Symbol">(</a><a id="23228" href="../Confluence/#23217" class="Bound">L</a> <a id="23230" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a><a id="23231" class="Symbol">)</a> <a id="23233" href="../Confluence/#23233" class="Bound">L⇛*N</a> <a id="23238" class="Symbol">=</a> <a id="23240" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23242" href="../Confluence/#23224" class="Bound">N</a> <a id="23244" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23246" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23248" href="../Confluence/#23233" class="Bound">L⇛*N</a> <a id="23253" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23255" href="../Confluence/#23224" class="Bound">N</a> <a id="23257" href="../Confluence/#4808" class="InductiveConstructor Operator">∎</a> <a id="23259" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="23261" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
<a id="23263" href="../Confluence/#23047" class="Function">par-confluence</a> <a id="23278" class="Symbol">{</a><a id="23279" href="../Confluence/#23279" class="Bound">Γ</a><a id="23280" class="Symbol">}{</a><a id="23282" href="../Confluence/#23282" class="Bound">A</a><a id="23283" class="Symbol">}{</a><a id="23285" href="../Confluence/#23285" class="Bound">L</a><a id="23286" class="Symbol">}{</a><a id="23288" href="../Confluence/#23288" class="Bound">M₁′</a><a id="23291" class="Symbol">}{</a><a id="23293" href="../Confluence/#23293" class="Bound">M₂</a><a id="23295" class="Symbol">}</a> <a id="23297" class="Symbol">(</a><a id="23298" href="../Confluence/#23285" class="Bound">L</a> <a id="23300" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="23303" href="../Confluence/#23303" class="Bound">L⇛M₁</a> <a id="23308" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="23310" href="../Confluence/#23310" class="Bound">M₁⇛*M₁′</a><a id="23317" class="Symbol">)</a> <a id="23319" href="../Confluence/#23319" class="Bound">L⇛*M₂</a>
    <a id="23329" class="Keyword">with</a> <a id="23334" href="../Confluence/#22488" class="Function">strip</a> <a id="23340" href="../Confluence/#23303" class="Bound">L⇛M₁</a> <a id="23345" href="../Confluence/#23319" class="Bound">L⇛*M₂</a>
<a id="23351" class="Symbol">...</a> <a id="23355" class="Symbol">|</a> <a id="23357" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23359" href="../Confluence/#23359" class="Bound">N</a> <a id="23361" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23363" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23365" href="../Confluence/#23365" class="Bound">M₁⇛*N</a> <a id="23371" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23373" href="../Confluence/#23373" class="Bound">M₂⇛N</a> <a id="23378" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="23380" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
      <a id="23388" class="Keyword">with</a> <a id="23393" href="../Confluence/#23047" class="Function">par-confluence</a> <a id="23408" class="Bound">M₁⇛*M₁′</a> <a id="23416" href="../Confluence/#23365" class="Bound">M₁⇛*N</a>
<a id="23422" class="Symbol">...</a>   <a id="23428" class="Symbol">|</a> <a id="23430" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23432" href="../Confluence/#23432" class="Bound">N′</a> <a id="23435" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23437" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23439" href="../Confluence/#23439" class="Bound">M₁′⇛*N′</a> <a id="23447" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23449" href="../Confluence/#23449" class="Bound">N⇛*N′</a> <a id="23455" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="23457" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="23459" class="Symbol">=</a>
        <a id="23469" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23471" href="../Confluence/#23432" class="Bound">N′</a> <a id="23474" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23476" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="23478" href="../Confluence/#23439" class="Bound">M₁′⇛*N′</a> <a id="23486" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="23488" class="Symbol">(</a><a id="23489" class="Bound">M₂</a> <a id="23492" href="../Confluence/#4864" class="InductiveConstructor Operator">⇛⟨</a> <a id="23495" class="Bound">M₂⇛N</a> <a id="23500" href="../Confluence/#4864" class="InductiveConstructor Operator">⟩</a> <a id="23502" href="../Confluence/#23449" class="Bound">N⇛*N′</a><a id="23507" class="Symbol">)</a> <a id="23509" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="23511" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
</pre>
<!--
The step case may be illustrated as follows:
-->
<p>归纳步骤可以如下图解释：</p>
<pre><code>        L
       / \
      1   *
     /     \
    M₁ (a)  M₂
   / \     /
  *   *   1
 /     \ /
M₁′(b)  N
 \     /
  *   *
   \ /
    N′</code></pre>
<!--
where downward lines are instances of `⇛` or `⇛*`, depending on how
they are marked. Here `(a)` holds by `strip` and `(b)` holds by
induction.
-->
<p>此处向下的线是 <code>⇛</code> 或 <code>⇛*</code> 的实例，取决于它们如何被标记。 此处 <code>(a)</code> 根据 <code>strip</code> 而成立，<code>(b)</code> 根据归纳假设而成立。</p>
<!--
## Proof of confluence for reduction
-->
<h2 id="规约合流性的证明">规约合流性的证明</h2>
<!--
Confluence of reduction is a corollary of confluence for parallel
reduction. From
`L —↠ M₁` and `L —↠ M₂` we have
`L ⇛* M₁` and `L ⇛* M₂` by `betas-pars`.
Then by confluence we obtain some `L` such that
`M₁ ⇛* N` and `M₂ ⇛* N`, from which we conclude that
`M₁ —↠ N` and `M₂ —↠ N` by `pars-betas`.
-->
<p>规约的合流性是平行规约合流性的一个推论。 从 <code>L —↠ M₁</code> 和 <code>L —↠ M₂</code> 根据 <code>betas-pars</code> 我们有 <code>L ⇛* M₁</code> 和 <code>L ⇛* M₂</code>。 接着根据合流性我们得到对于某个 <code>L</code> 有 <code>M₁ ⇛* N</code> 和 <code>M₂ ⇛* N</code>。 因此我们根据 <code>pars-betas</code> 得出 <code>M₁ —↠ N</code> 和 <code>M₂ —↠ N</code>。</p>
<pre class="Agda"><a id="confluence"></a><a id="24560" href="../Confluence/#24560" class="Function">confluence</a> <a id="24571" class="Symbol">:</a> <a id="24573" class="Symbol">∀{</a><a id="24575" href="../Confluence/#24575" class="Bound">Γ</a> <a id="24577" href="../Confluence/#24577" class="Bound">A</a><a id="24578" class="Symbol">}</a> <a id="24580" class="Symbol">{</a><a id="24581" href="../Confluence/#24581" class="Bound">L</a> <a id="24583" href="../Confluence/#24583" class="Bound">M₁</a> <a id="24586" href="../Confluence/#24586" class="Bound">M₂</a> <a id="24589" class="Symbol">:</a> <a id="24591" href="../Confluence/#24575" class="Bound">Γ</a> <a id="24593" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="24595" href="../Confluence/#24577" class="Bound">A</a><a id="24596" class="Symbol">}</a>
  <a id="24600" class="Symbol">→</a> <a id="24602" href="../Confluence/#24581" class="Bound">L</a> <a id="24604" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="24607" href="../Confluence/#24583" class="Bound">M₁</a>
  <a id="24612" class="Symbol">→</a> <a id="24614" href="../Confluence/#24581" class="Bound">L</a> <a id="24616" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="24619" href="../Confluence/#24586" class="Bound">M₂</a>
    <a id="24626" class="Comment">-----------------------------------</a>
  <a id="24664" class="Symbol">→</a> <a id="24666" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Σ[</a> <a id="24669" href="../Confluence/#24669" class="Bound">N</a> <a id="24671" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">∈</a> <a id="24673" href="../Confluence/#24575" class="Bound">Γ</a> <a id="24675" href="../Untyped/#4276" class="Datatype Operator">⊢</a> <a id="24677" href="../Confluence/#24577" class="Bound">A</a> <a id="24679" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="24681" class="Symbol">(</a><a id="24682" href="../Confluence/#24583" class="Bound">M₁</a> <a id="24685" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="24688" href="../Confluence/#24669" class="Bound">N</a><a id="24689" class="Symbol">)</a> <a id="24691" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">×</a> <a id="24693" class="Symbol">(</a><a id="24694" href="../Confluence/#24586" class="Bound">M₂</a> <a id="24697" href="../Untyped/#11050" class="Datatype Operator">—↠</a> <a id="24700" href="../Confluence/#24669" class="Bound">N</a><a id="24701" class="Symbol">)</a>
<a id="24703" href="../Confluence/#24560" class="Function">confluence</a> <a id="24714" href="../Confluence/#24714" class="Bound">L↠M₁</a> <a id="24719" href="../Confluence/#24719" class="Bound">L↠M₂</a>
    <a id="24728" class="Keyword">with</a> <a id="24733" href="../Confluence/#23047" class="Function">par-confluence</a> <a id="24748" class="Symbol">(</a><a id="24749" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="24760" href="../Confluence/#24714" class="Bound">L↠M₁</a><a id="24764" class="Symbol">)</a> <a id="24766" class="Symbol">(</a><a id="24767" href="../Confluence/#6297" class="Function">betas-pars</a> <a id="24778" href="../Confluence/#24719" class="Bound">L↠M₂</a><a id="24782" class="Symbol">)</a>
<a id="24784" class="Symbol">...</a> <a id="24788" class="Symbol">|</a> <a id="24790" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="24792" href="../Confluence/#24792" class="Bound">N</a> <a id="24794" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="24796" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="24798" href="../Confluence/#24798" class="Bound">M₁⇛N</a> <a id="24803" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="24805" href="../Confluence/#24805" class="Bound">M₂⇛N</a> <a id="24810" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="24812" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="24814" class="Symbol">=</a>
      <a id="24822" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="24824" href="../Confluence/#24792" class="Bound">N</a> <a id="24826" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="24828" href="../Confluence/#2999" class="InductiveConstructor Operator">⟨</a> <a id="24830" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="24841" href="../Confluence/#24798" class="Bound">M₁⇛N</a> <a id="24846" href="../Confluence/#2999" class="InductiveConstructor Operator">,</a> <a id="24848" href="../Confluence/#8852" class="Function">pars-betas</a> <a id="24859" href="../Confluence/#24805" class="Bound">M₂⇛N</a> <a id="24864" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a> <a id="24866" href="../Confluence/#2999" class="InductiveConstructor Operator">⟩</a>
</pre>
<!--
## Notes
-->
<h2 id="注记">注记</h2>
<!--
Broadly speaking, this proof of confluence, based on parallel
reduction, is due to W. Tait and P. Martin-Löf (see Barendregt 1984,
Section 3.2).  Details of the mechanization come from several sources.
The `subst-par` lemma is the "strong substitutivity" lemma of Shafer,
Tebbi, and Smolka (ITP 2015). The proofs of `par-triangle`, `strip`,
and `par-confluence` are based on the notion of complete development
by Takahashi (1995) and Pfenning's 1992 technical report about the
Church-Rosser theorem. In addition, we consulted Nipkow and
Berghofer's mechanization in Isabelle, which is based on an earlier
article by Nipkow (JAR 1996).
-->
<p>总而言之，这种基于平行规约的合流性的证明 归功于 W. Tait 和 P. Martin-Löf （参见 Barendregt 1984，章节 3.2）。 机械化的细节有多个来源。 <code>subst-par</code> 引理是 Shafer、Tebbi 和 Smolka (ITP 2015) 的 “强替换性（Strong Substitutivity）” 引理。 <code>par-triangle</code>、<code>strip</code> 和 <code>par-confluence</code> 的证明是基于 Takahashi (1995) 的 complete development 和 Pfenning 1992 年关于 Church-Rosser 定理的技术报告。 此外，我们咨询了 Nipkow 和 Berghofer 在 Isabelle 中的机械化， 它基于 Nipkow 的早期文章（JAR 1996）。</p>
<h2 id="unicode">Unicode</h2>
<!--
This chapter uses the following unicode:
-->
<p>本章中使用了以下 Unicode：</p>
<pre><code>⇛  U+21DB  RIGHTWARDS TRIPLE ARROW (\r== or \Rrightarrow)
⁺  U+207A  SUPERSCRIPT PLUS SIGN   (\^+)</code></pre>
    </div>
    <nav class="pager">
    <ul class="pagination">
        
        <li><a class="pagelink" href="../Untyped/">上一章</a></li>
        <li class="separator">&bullet;</li>
        
        
        <li><a class="pagelink" href="https://github.com/Agda-zh/PLFA-zh/blob/dev/src/plfa/part2/Confluence.lagda.md">源文件</a></li>
        <li class="separator">&bullet;</li>
        
        
        <li><a class="pagelink" href="../BigStep/">下一章</a></li>
        <li class="separator">&bullet;</li>
        
    </ul>
</nav>

</article>

            </div>
        </main>
        <footer class="site-footer h-card">
    <data class="u-url" href="../"></data>
    <div class="wrapper">
        <h2 class="footer-heading">编程语言基础：Agda 语言描述</h2>
        
        
        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list">
                    <li class="p-name">Philip Wadler</li>
                    <li>
                        
                        <a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a>
                        
                    </li>
                </ul>
            </div>
            <div class="footer-col footer-col-2">
                <ul class="social-media-list">
    
    <li><a rel="me" href="https://github.com/wadler" title="wadler"><svg class="svg-icon grey"><use xlink:href="/public/minima-social-icons.svg#github"></use></svg>&nbsp;wadler</a></li>
    
    
</ul>

            </div>
            <div class="footer-col footer-col-3">
                
            </div>
        </div>
        
        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list">
                    <li class="p-name">Wen Kokke</li>
                    <li>
                        
                        <a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a>
                        
                    </li>
                </ul>
            </div>
            <div class="footer-col footer-col-2">
                <ul class="social-media-list">
    
    <li><a rel="me" href="https://github.com/wenkokke" title="wenkokke"><svg class="svg-icon grey"><use xlink:href="/public/minima-social-icons.svg#github"></use></svg>&nbsp;wenkokke</a></li>
    
    
    <li><a rel="me" href="https://twitter.com/wenkokke" title="wenkokke"><svg class="svg-icon grey"><use xlink:href="/public/minima-social-icons.svg#twitter"></use></svg>&nbsp;wenkokke</a></li>
    
</ul>

            </div>
            <div class="footer-col footer-col-3">
                
            </div>
        </div>
        
        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list">
                    <li class="p-name">Jeremy G. Siek</li>
                    <li>
                        
                        <a class="u-email" href="mailto:jsiek@indiana.edu">jsiek@indiana.edu</a>
                        
                    </li>
                </ul>
            </div>
            <div class="footer-col footer-col-2">
                <ul class="social-media-list">
    
    <li><a rel="me" href="https://github.com/jsiek" title="jsiek"><svg class="svg-icon grey"><use xlink:href="/public/minima-social-icons.svg#github"></use></svg>&nbsp;jsiek</a></li>
    
    
    <li><a rel="me" href="https://twitter.com/jeremysiek" title="jeremysiek"><svg class="svg-icon grey"><use xlink:href="/public/minima-social-icons.svg#twitter"></use></svg>&nbsp;jeremysiek</a></li>
    
</ul>

            </div>
            <div class="footer-col footer-col-3">
                
            </div>
        </div>
        
        
        This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
    </div>
</footer>

    </body>
</html>
